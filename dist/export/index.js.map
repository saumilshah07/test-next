{"version":3,"sources":["../../export/index.ts"],"sourcesContent":["import chalk from 'chalk'\nimport findUp from 'next/dist/compiled/find-up'\nimport {\n  promises,\n  existsSync,\n  exists as existsOrig,\n  readFileSync,\n  writeFileSync,\n} from 'fs'\nimport { Worker } from '../lib/worker'\nimport { dirname, join, resolve, sep } from 'path'\nimport { promisify } from 'util'\nimport { AmpPageStatus, formatAmpMessages } from '../build/output/index'\nimport * as Log from '../build/output/log'\nimport createSpinner from '../build/spinner'\nimport { API_ROUTE, SSG_FALLBACK_EXPORT_ERROR } from '../lib/constants'\nimport { recursiveCopy } from '../lib/recursive-copy'\nimport { recursiveDelete } from '../lib/recursive-delete'\nimport {\n  BUILD_ID_FILE,\n  CLIENT_PUBLIC_FILES_PATH,\n  CLIENT_STATIC_FILES_PATH,\n  CONFIG_FILE,\n  EXPORT_DETAIL,\n  EXPORT_MARKER,\n  PAGES_MANIFEST,\n  PHASE_EXPORT,\n  PRERENDER_MANIFEST,\n  SERVERLESS_DIRECTORY,\n  SERVER_DIRECTORY,\n} from '../shared/lib/constants'\nimport loadConfig, { isTargetLikeServerless } from '../server/config'\nimport { NextConfigComplete } from '../server/config-shared'\nimport { eventCliSession } from '../telemetry/events'\nimport { hasNextSupport } from '../telemetry/ci-info'\nimport { Telemetry } from '../telemetry/storage'\nimport {\n  normalizePagePath,\n  denormalizePagePath,\n} from '../server/normalize-page-path'\nimport { loadEnvConfig } from '@next/env'\nimport { PrerenderManifest } from '../build'\nimport { PagesManifest } from '../build/webpack/plugins/pages-manifest-plugin'\nimport { getPagePath } from '../server/require'\nimport { trace } from '../telemetry/trace'\n\nconst exists = promisify(existsOrig)\n\nfunction divideSegments(number: number, segments: number): number[] {\n  const result = []\n  while (number > 0 && segments > 0) {\n    const dividedNumber =\n      number < segments ? number : Math.floor(number / segments)\n\n    number -= dividedNumber\n    segments--\n    result.push(dividedNumber)\n  }\n  return result\n}\n\nconst createProgress = (total: number, label: string) => {\n  const segments = divideSegments(total, 4)\n\n  if (total === 0) {\n    throw new Error('invariant: progress total can not be zero')\n  }\n  let currentSegmentTotal = segments.shift()\n  let currentSegmentCount = 0\n  let lastProgressOutput = Date.now()\n  let curProgress = 0\n  let progressSpinner = createSpinner(`${label} (${curProgress}/${total})`, {\n    spinner: {\n      frames: [\n        '[    ]',\n        '[=   ]',\n        '[==  ]',\n        '[=== ]',\n        '[ ===]',\n        '[  ==]',\n        '[   =]',\n        '[    ]',\n        '[   =]',\n        '[  ==]',\n        '[ ===]',\n        '[====]',\n        '[=== ]',\n        '[==  ]',\n        '[=   ]',\n      ],\n      interval: 500,\n    },\n  })\n\n  return () => {\n    curProgress++\n\n    // Make sure we only log once\n    // - per fully generated segment, or\n    // - per minute\n    // when not showing the spinner\n    if (!progressSpinner) {\n      currentSegmentCount++\n\n      if (currentSegmentCount === currentSegmentTotal) {\n        currentSegmentTotal = segments.shift()\n        currentSegmentCount = 0\n      } else if (lastProgressOutput + 60000 > Date.now()) {\n        return\n      }\n\n      lastProgressOutput = Date.now()\n    }\n\n    const newText = `${label} (${curProgress}/${total})`\n    if (progressSpinner) {\n      progressSpinner.text = newText\n    } else {\n      console.log(newText)\n    }\n\n    if (curProgress === total && progressSpinner) {\n      progressSpinner.stop()\n      console.log(newText)\n    }\n  }\n}\n\ntype ExportPathMap = {\n  [page: string]: { page: string; query?: { [key: string]: string } }\n}\n\ninterface ExportOptions {\n  outdir: string\n  silent?: boolean\n  threads?: number\n  pages?: string[]\n  buildExport?: boolean\n  statusMessage?: string\n  exportPageWorker?: typeof import('./worker').default\n  endWorker?: () => Promise<void>\n}\n\nexport default async function exportApp(\n  dir: string,\n  options: ExportOptions,\n  configuration?: NextConfigComplete\n): Promise<void> {\n  const nextExportSpan = trace('next-export')\n\n  return nextExportSpan.traceAsyncFn(async () => {\n    dir = resolve(dir)\n\n    // attempt to load global env values so they are available in next.config.js\n    nextExportSpan\n      .traceChild('load-dotenv')\n      .traceFn(() => loadEnvConfig(dir, false, Log))\n\n    const nextConfig =\n      configuration ||\n      (await nextExportSpan\n        .traceChild('load-next-config')\n        .traceAsyncFn(() => loadConfig(PHASE_EXPORT, dir)))\n    const threads = options.threads || nextConfig.experimental.cpus\n    const distDir = join(dir, nextConfig.distDir)\n\n    const telemetry = options.buildExport ? null : new Telemetry({ distDir })\n\n    if (telemetry) {\n      telemetry.record(\n        eventCliSession(PHASE_EXPORT, distDir, {\n          webpackVersion: null,\n          cliCommand: 'export',\n          isSrcDir: null,\n          hasNowJson: !!(await findUp('now.json', { cwd: dir })),\n          isCustomServer: null,\n        })\n      )\n    }\n\n    const subFolders = nextConfig.trailingSlash && !options.buildExport\n    const isLikeServerless = nextConfig.target !== 'server'\n\n    if (!options.silent && !options.buildExport) {\n      Log.info(`using build directory: ${distDir}`)\n    }\n\n    const buildIdFile = join(distDir, BUILD_ID_FILE)\n\n    if (!existsSync(buildIdFile)) {\n      throw new Error(\n        `Could not find a production build in the '${distDir}' directory. Try building your app with 'next build' before starting the static export. https://nextjs.org/docs/messages/next-export-no-build-id`\n      )\n    }\n\n    const customRoutesDetected = ['rewrites', 'redirects', 'headers'].filter(\n      (config) => typeof nextConfig[config] === 'function'\n    )\n\n    if (\n      !hasNextSupport &&\n      !options.buildExport &&\n      customRoutesDetected.length > 0\n    ) {\n      Log.warn(\n        `rewrites, redirects, and headers are not applied when exporting your application, detected (${customRoutesDetected.join(\n          ', '\n        )}). See more info here: https://nextjs.org/docs/messages/export-no-custom-routes`\n      )\n    }\n\n    const buildId = readFileSync(buildIdFile, 'utf8')\n    const pagesManifest =\n      !options.pages &&\n      (require(join(\n        distDir,\n        isLikeServerless ? SERVERLESS_DIRECTORY : SERVER_DIRECTORY,\n        PAGES_MANIFEST\n      )) as PagesManifest)\n\n    let prerenderManifest: PrerenderManifest | undefined = undefined\n    try {\n      prerenderManifest = require(join(distDir, PRERENDER_MANIFEST))\n    } catch (_) {}\n\n    const excludedPrerenderRoutes = new Set<string>()\n    const pages = options.pages || Object.keys(pagesManifest)\n    const defaultPathMap: ExportPathMap = {}\n    let hasApiRoutes = false\n\n    for (const page of pages) {\n      // _document and _app are not real pages\n      // _error is exported as 404.html later on\n      // API Routes are Node.js functions\n\n      if (page.match(API_ROUTE)) {\n        hasApiRoutes = true\n        continue\n      }\n\n      if (page === '/_document' || page === '/_app' || page === '/_error') {\n        continue\n      }\n\n      // iSSG pages that are dynamic should not export templated version by\n      // default. In most cases, this would never work. There is no server that\n      // could run `getStaticProps`. If users make their page work lazily, they\n      // can manually add it to the `exportPathMap`.\n      if (prerenderManifest?.dynamicRoutes[page]) {\n        excludedPrerenderRoutes.add(page)\n        continue\n      }\n\n      defaultPathMap[page] = { page }\n    }\n\n    // Initialize the output directory\n    const outDir = options.outdir\n\n    if (outDir === join(dir, 'public')) {\n      throw new Error(\n        `The 'public' directory is reserved in Next.js and can not be used as the export out directory. https://nextjs.org/docs/messages/can-not-output-to-public`\n      )\n    }\n\n    if (outDir === join(dir, 'static')) {\n      throw new Error(\n        `The 'static' directory is reserved in Next.js and can not be used as the export out directory. https://nextjs.org/docs/messages/can-not-output-to-static`\n      )\n    }\n\n    await recursiveDelete(join(outDir))\n    await promises.mkdir(join(outDir, '_next', buildId), { recursive: true })\n\n    writeFileSync(\n      join(distDir, EXPORT_DETAIL),\n      JSON.stringify({\n        version: 1,\n        outDirectory: outDir,\n        success: false,\n      }),\n      'utf8'\n    )\n\n    // Copy static directory\n    if (!options.buildExport && existsSync(join(dir, 'static'))) {\n      if (!options.silent) {\n        Log.info('Copying \"static\" directory')\n      }\n      await nextExportSpan\n        .traceChild('copy-static-directory')\n        .traceAsyncFn(() =>\n          recursiveCopy(join(dir, 'static'), join(outDir, 'static'))\n        )\n    }\n\n    // Copy .next/static directory\n    if (\n      !options.buildExport &&\n      existsSync(join(distDir, CLIENT_STATIC_FILES_PATH))\n    ) {\n      if (!options.silent) {\n        Log.info('Copying \"static build\" directory')\n      }\n      await nextExportSpan\n        .traceChild('copy-next-static-directory')\n        .traceAsyncFn(() =>\n          recursiveCopy(\n            join(distDir, CLIENT_STATIC_FILES_PATH),\n            join(outDir, '_next', CLIENT_STATIC_FILES_PATH)\n          )\n        )\n    }\n\n    // Get the exportPathMap from the config file\n    if (typeof nextConfig.exportPathMap !== 'function') {\n      if (!options.silent) {\n        Log.info(\n          `No \"exportPathMap\" found in \"${CONFIG_FILE}\". Generating map from \"./pages\"`\n        )\n      }\n      nextConfig.exportPathMap = async (defaultMap: ExportPathMap) => {\n        return defaultMap\n      }\n    }\n\n    const {\n      i18n,\n      images: { loader = 'default' },\n    } = nextConfig\n\n    if (i18n && !options.buildExport) {\n      throw new Error(\n        `i18n support is not compatible with next export. See here for more info on deploying: https://nextjs.org/docs/deployment`\n      )\n    }\n\n    if (!options.buildExport) {\n      const { isNextImageImported } = await nextExportSpan\n        .traceChild('is-next-image-imported')\n        .traceAsyncFn(() =>\n          promises\n            .readFile(join(distDir, EXPORT_MARKER), 'utf8')\n            .then((text) => JSON.parse(text))\n            .catch(() => ({}))\n        )\n\n      if (isNextImageImported && loader === 'default' && !hasNextSupport) {\n        throw new Error(\n          `Image Optimization using Next.js' default loader is not compatible with \\`next export\\`.\n  Possible solutions:\n    - Use \\`next start\\` to run a server, which includes the Image Optimization API.\n    - Use any provider which supports Image Optimization (like Vercel).\n    - Configure a third-party loader in \\`next.config.js\\`.\n    - Use the \\`loader\\` prop for \\`next/image\\`.\n  Read more: https://nextjs.org/docs/messages/export-image-api`\n        )\n      }\n    }\n\n    // Start the rendering process\n    const renderOpts = {\n      dir,\n      buildId,\n      nextExport: true,\n      assetPrefix: nextConfig.assetPrefix.replace(/\\/$/, ''),\n      distDir,\n      dev: false,\n      hotReloader: null,\n      basePath: nextConfig.basePath,\n      canonicalBase: nextConfig.amp?.canonicalBase || '',\n      ampValidatorPath: nextConfig.experimental.amp?.validator || undefined,\n      ampSkipValidation: nextConfig.experimental.amp?.skipValidation || false,\n      ampOptimizerConfig: nextConfig.experimental.amp?.optimizer || undefined,\n      locales: i18n?.locales,\n      locale: i18n?.defaultLocale,\n      defaultLocale: i18n?.defaultLocale,\n      domainLocales: i18n?.domains,\n      trailingSlash: nextConfig.trailingSlash,\n      disableOptimizedLoading: nextConfig.experimental.disableOptimizedLoading,\n      // TODO: We should support dynamic HTML too\n      requireStaticHTML: true,\n      concurrentFeatures: nextConfig.experimental.concurrentFeatures,\n    }\n\n    const { serverRuntimeConfig, publicRuntimeConfig } = nextConfig\n\n    if (Object.keys(publicRuntimeConfig).length > 0) {\n      ;(renderOpts as any).runtimeConfig = publicRuntimeConfig\n    }\n\n    // We need this for server rendering the Link component.\n    ;(global as any).__NEXT_DATA__ = {\n      nextExport: true,\n    }\n\n    if (!options.silent && !options.buildExport) {\n      Log.info(`Launching ${threads} workers`)\n    }\n    const exportPathMap = await nextExportSpan\n      .traceChild('run-export-path-map')\n      .traceAsyncFn(() =>\n        nextConfig.exportPathMap(defaultPathMap, {\n          dev: false,\n          dir,\n          outDir,\n          distDir,\n          buildId,\n        })\n      )\n\n    if (\n      !options.buildExport &&\n      !exportPathMap['/404'] &&\n      !exportPathMap['/404.html']\n    ) {\n      exportPathMap['/404'] = exportPathMap['/404.html'] = {\n        page: '/_error',\n      }\n    }\n\n    // make sure to prevent duplicates\n    const exportPaths = [\n      ...new Set(\n        Object.keys(exportPathMap).map((path) =>\n          denormalizePagePath(normalizePagePath(path))\n        )\n      ),\n    ]\n\n    const filteredPaths = exportPaths.filter(\n      // Remove API routes\n      (route) => !exportPathMap[route].page.match(API_ROUTE)\n    )\n\n    if (filteredPaths.length !== exportPaths.length) {\n      hasApiRoutes = true\n    }\n\n    if (filteredPaths.length === 0) {\n      return\n    }\n\n    if (prerenderManifest && !options.buildExport) {\n      const fallbackEnabledPages = new Set()\n\n      for (const key of Object.keys(prerenderManifest.dynamicRoutes)) {\n        // only error if page is included in path map\n        if (!exportPathMap[key] && !excludedPrerenderRoutes.has(key)) {\n          continue\n        }\n\n        if (prerenderManifest.dynamicRoutes[key].fallback !== false) {\n          fallbackEnabledPages.add(key)\n        }\n      }\n\n      if (fallbackEnabledPages.size) {\n        throw new Error(\n          `Found pages with \\`fallback\\` enabled:\\n${[\n            ...fallbackEnabledPages,\n          ].join('\\n')}\\n${SSG_FALLBACK_EXPORT_ERROR}\\n`\n        )\n      }\n    }\n\n    // Warn if the user defines a path for an API page\n    if (hasApiRoutes) {\n      if (!options.silent) {\n        Log.warn(\n          chalk.yellow(\n            `Statically exporting a Next.js application via \\`next export\\` disables API routes.`\n          ) +\n            `\\n` +\n            chalk.yellow(\n              `This command is meant for static-only hosts, and is` +\n                ' ' +\n                chalk.bold(`not necessary to make your application static.`)\n            ) +\n            `\\n` +\n            chalk.yellow(\n              `Pages in your application without server-side data dependencies will be automatically statically exported by \\`next build\\`, including pages powered by \\`getStaticProps\\`.`\n            ) +\n            `\\n` +\n            chalk.yellow(\n              `Learn more: https://nextjs.org/docs/messages/api-routes-static-export`\n            )\n        )\n      }\n    }\n\n    const progress =\n      !options.silent &&\n      createProgress(\n        filteredPaths.length,\n        `${Log.prefixes.info} ${options.statusMessage || 'Exporting'}`\n      )\n    const pagesDataDir = options.buildExport\n      ? outDir\n      : join(outDir, '_next/data', buildId)\n\n    const ampValidations: AmpPageStatus = {}\n    let hadValidationError = false\n\n    const publicDir = join(dir, CLIENT_PUBLIC_FILES_PATH)\n    // Copy public directory\n    if (!options.buildExport && existsSync(publicDir)) {\n      if (!options.silent) {\n        Log.info('Copying \"public\" directory')\n      }\n      await nextExportSpan\n        .traceChild('copy-public-directory')\n        .traceAsyncFn(() =>\n          recursiveCopy(publicDir, outDir, {\n            filter(path) {\n              // Exclude paths used by pages\n              return !exportPathMap[path]\n            },\n          })\n        )\n    }\n\n    const timeout = configuration?.experimental.staticPageGenerationTimeout || 0\n    let infoPrinted = false\n    let exportPage: typeof import('./worker').default\n    let endWorker: () => Promise<void>\n    if (options.exportPageWorker) {\n      exportPage = options.exportPageWorker\n      endWorker = options.endWorker || (() => Promise.resolve())\n    } else {\n      const worker = new Worker(require.resolve('./worker'), {\n        timeout: timeout * 1000,\n        onRestart: (_method, [{ path }], attempts) => {\n          if (attempts >= 3) {\n            throw new Error(\n              `Static page generation for ${path} is still timing out after 3 attempts. See more info here https://nextjs.org/docs/messages/static-page-generation-timeout`\n            )\n          }\n          Log.warn(\n            `Restarted static page genertion for ${path} because it took more than ${timeout} seconds`\n          )\n          if (!infoPrinted) {\n            Log.warn(\n              'See more info here https://nextjs.org/docs/messages/static-page-generation-timeout'\n            )\n            infoPrinted = true\n          }\n        },\n        maxRetries: 0,\n        numWorkers: threads,\n        enableWorkerThreads: nextConfig.experimental.workerThreads,\n        exposedMethods: ['default'],\n      }) as Worker & typeof import('./worker')\n      exportPage = worker.default.bind(worker)\n      endWorker = async () => {\n        await worker.end()\n      }\n    }\n\n    let renderError = false\n    const errorPaths: string[] = []\n\n    await Promise.all(\n      filteredPaths.map(async (path) => {\n        const pageExportSpan = nextExportSpan.traceChild('export-page')\n        pageExportSpan.setAttribute('path', path)\n\n        return pageExportSpan.traceAsyncFn(async () => {\n          const pathMap = exportPathMap[path]\n          const result = await exportPage({\n            path,\n            pathMap,\n            distDir,\n            outDir,\n            pagesDataDir,\n            renderOpts,\n            serverRuntimeConfig,\n            subFolders,\n            buildExport: options.buildExport,\n            serverless: isTargetLikeServerless(nextConfig.target),\n            optimizeFonts: nextConfig.optimizeFonts,\n            optimizeImages: nextConfig.experimental.optimizeImages,\n            optimizeCss: nextConfig.experimental.optimizeCss,\n            disableOptimizedLoading:\n              nextConfig.experimental.disableOptimizedLoading,\n            parentSpanId: pageExportSpan.id,\n            httpAgentOptions: nextConfig.httpAgentOptions,\n          })\n\n          for (const validation of result.ampValidations || []) {\n            const { page, result: ampValidationResult } = validation\n            ampValidations[page] = ampValidationResult\n            hadValidationError =\n              hadValidationError ||\n              (Array.isArray(ampValidationResult?.errors) &&\n                ampValidationResult.errors.length > 0)\n          }\n          renderError = renderError || !!result.error\n          if (!!result.error) errorPaths.push(path)\n\n          if (options.buildExport && configuration) {\n            if (typeof result.fromBuildExportRevalidate !== 'undefined') {\n              configuration.initialPageRevalidationMap[path] =\n                result.fromBuildExportRevalidate\n            }\n\n            if (result.ssgNotFound === true) {\n              configuration.ssgNotFoundPaths.push(path)\n            }\n\n            const durations = (configuration.pageDurationMap[pathMap.page] =\n              configuration.pageDurationMap[pathMap.page] || {})\n            durations[path] = result.duration\n          }\n\n          if (progress) progress()\n        })\n      })\n    )\n\n    const endWorkerPromise = endWorker()\n\n    // copy prerendered routes to outDir\n    if (!options.buildExport && prerenderManifest) {\n      await Promise.all(\n        Object.keys(prerenderManifest.routes).map(async (route) => {\n          const { srcRoute } = prerenderManifest!.routes[route]\n          const pageName = srcRoute || route\n          const pagePath = getPagePath(pageName, distDir, isLikeServerless)\n          const distPagesDir = join(\n            pagePath,\n            // strip leading / and then recurse number of nested dirs\n            // to place from base folder\n            pageName\n              .substr(1)\n              .split('/')\n              .map(() => '..')\n              .join('/')\n          )\n          route = normalizePagePath(route)\n\n          const orig = join(distPagesDir, route)\n          const htmlDest = join(\n            outDir,\n            `${route}${\n              subFolders && route !== '/index' ? `${sep}index` : ''\n            }.html`\n          )\n          const ampHtmlDest = join(\n            outDir,\n            `${route}.amp${subFolders ? `${sep}index` : ''}.html`\n          )\n          const jsonDest = join(pagesDataDir, `${route}.json`)\n\n          await promises.mkdir(dirname(htmlDest), { recursive: true })\n          await promises.mkdir(dirname(jsonDest), { recursive: true })\n          await promises.copyFile(`${orig}.html`, htmlDest)\n          await promises.copyFile(`${orig}.json`, jsonDest)\n\n          if (await exists(`${orig}.amp.html`)) {\n            await promises.mkdir(dirname(ampHtmlDest), { recursive: true })\n            await promises.copyFile(`${orig}.amp.html`, ampHtmlDest)\n          }\n        })\n      )\n    }\n\n    if (Object.keys(ampValidations).length) {\n      console.log(formatAmpMessages(ampValidations))\n    }\n    if (hadValidationError) {\n      throw new Error(\n        `AMP Validation caused the export to fail. https://nextjs.org/docs/messages/amp-export-validation`\n      )\n    }\n\n    if (renderError) {\n      throw new Error(\n        `Export encountered errors on following paths:\\n\\t${errorPaths\n          .sort()\n          .join('\\n\\t')}`\n      )\n    }\n\n    writeFileSync(\n      join(distDir, EXPORT_DETAIL),\n      JSON.stringify({\n        version: 1,\n        outDirectory: outDir,\n        success: true,\n      }),\n      'utf8'\n    )\n\n    if (telemetry) {\n      await telemetry.flush()\n    }\n\n    await endWorkerPromise\n  })\n}\n"],"names":["exportApp","Log","exists","divideSegments","number","segments","result","dividedNumber","Math","floor","push","createProgress","total","label","Error","currentSegmentTotal","shift","currentSegmentCount","lastProgressOutput","Date","now","curProgress","progressSpinner","spinner","frames","interval","newText","text","console","log","stop","dir","options","configuration","nextExportSpan","traceAsyncFn","nextConfig","traceChild","traceFn","threads","experimental","cpus","distDir","telemetry","buildExport","record","webpackVersion","cliCommand","isSrcDir","hasNowJson","cwd","isCustomServer","subFolders","trailingSlash","isLikeServerless","target","silent","info","buildIdFile","customRoutesDetected","filter","config","length","warn","join","buildId","pagesManifest","pages","require","prerenderManifest","undefined","_","excludedPrerenderRoutes","Set","Object","keys","defaultPathMap","hasApiRoutes","page","match","dynamicRoutes","add","outDir","outdir","mkdir","recursive","JSON","stringify","version","outDirectory","success","exportPathMap","defaultMap","i18n","images","loader","isNextImageImported","readFile","then","parse","catch","renderOpts","nextExport","assetPrefix","replace","dev","hotReloader","basePath","canonicalBase","amp","ampValidatorPath","validator","ampSkipValidation","skipValidation","ampOptimizerConfig","optimizer","locales","locale","defaultLocale","domainLocales","domains","disableOptimizedLoading","requireStaticHTML","concurrentFeatures","serverRuntimeConfig","publicRuntimeConfig","runtimeConfig","global","__NEXT_DATA__","exportPaths","map","path","filteredPaths","route","fallbackEnabledPages","key","has","fallback","size","yellow","bold","progress","prefixes","statusMessage","pagesDataDir","ampValidations","hadValidationError","publicDir","timeout","staticPageGenerationTimeout","infoPrinted","exportPage","endWorker","exportPageWorker","Promise","resolve","worker","onRestart","_method","attempts","maxRetries","numWorkers","enableWorkerThreads","workerThreads","exposedMethods","default","bind","end","renderError","errorPaths","all","pageExportSpan","setAttribute","pathMap","serverless","optimizeFonts","optimizeImages","optimizeCss","parentSpanId","id","httpAgentOptions","validation","ampValidationResult","Array","isArray","errors","error","fromBuildExportRevalidate","initialPageRevalidationMap","ssgNotFound","ssgNotFoundPaths","durations","pageDurationMap","duration","endWorkerPromise","routes","srcRoute","pageName","pagePath","distPagesDir","substr","split","orig","htmlDest","ampHtmlDest","jsonDest","copyFile","sort","flush"],"mappings":"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"}