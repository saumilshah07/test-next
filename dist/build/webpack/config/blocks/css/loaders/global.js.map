{"version":3,"sources":["../../../../../../../build/webpack/config/blocks/css/loaders/global.ts"],"sourcesContent":["import { AcceptedPlugin } from 'postcss'\nimport { webpack } from 'next/dist/compiled/webpack/webpack'\nimport { ConfigurationContext } from '../../../utils'\nimport { getClientStyleLoader } from './client'\nimport { cssFileResolve } from './file-resolve'\n\nexport function getGlobalCssLoader(\n  ctx: ConfigurationContext,\n  postCssPlugins: readonly AcceptedPlugin[],\n  preProcessors: readonly webpack.RuleSetUseItem[] = []\n): webpack.RuleSetUseItem[] {\n  const loaders: webpack.RuleSetUseItem[] = []\n\n  if (ctx.isClient) {\n    // Add appropriate development more or production mode style\n    // loader\n    loaders.push(\n      getClientStyleLoader({\n        isDevelopment: ctx.isDevelopment,\n        assetPrefix: ctx.assetPrefix,\n      })\n    )\n  }\n\n  // Resolve CSS `@import`s and `url()`s\n  loaders.push({\n    loader: require.resolve('next/dist/compiled/css-loader'),\n    options: {\n      importLoaders: 1 + preProcessors.length,\n      // Next.js controls CSS Modules eligibility:\n      modules: false,\n      url: cssFileResolve,\n      import: (url: string, _: any, resourcePath: string) =>\n        cssFileResolve(url, resourcePath),\n    },\n  })\n\n  // Compile CSS\n  loaders.push({\n    loader: require.resolve('next/dist/compiled/postcss-loader'),\n    options: {\n      postcssOptions: { plugins: postCssPlugins, config: false },\n    },\n  })\n\n  loaders.push(\n    // Webpack loaders run like a stack, so we need to reverse the natural\n    // order of preprocessors.\n    ...preProcessors.slice().reverse()\n  )\n\n  return loaders\n}\n"],"names":["getGlobalCssLoader","ctx","postCssPlugins","preProcessors","loaders","isClient","push","isDevelopment","assetPrefix","loader","require","resolve","options","importLoaders","length","modules","url","import","_","resourcePath","postcssOptions","plugins","config","slice","reverse"],"mappings":";;;;QAMgBA,kBAAkB,GAAlBA,kBAAkB;AAHG,GAAU,CAAV,OAAU;AAChB,GAAgB,CAAhB,YAAgB;SAE/BA,kBAAkB,CAChCC,GAAyB,EACzBC,cAAyC,EACzCC,aAAgD,GAAG,CAAC,CAAC,EAC3B,CAAC;IAC3B,KAAK,CAACC,OAAO,GAA6B,CAAC,CAAC;IAE5C,EAAE,EAAEH,GAAG,CAACI,QAAQ,EAAE,CAAC;QACjB,EAA4D,AAA5D,0DAA4D;QAC5D,EAAS,AAAT,OAAS;QACTD,OAAO,CAACE,IAAI,KAbqB,OAAU,uBAcpB,CAAC;YACpBC,aAAa,EAAEN,GAAG,CAACM,aAAa;YAChCC,WAAW,EAAEP,GAAG,CAACO,WAAW;QAC9B,CAAC;IAEL,CAAC;IAED,EAAsC,AAAtC,oCAAsC;IACtCJ,OAAO,CAACE,IAAI,CAAC,CAAC;QACZG,MAAM,EAAEC,OAAO,CAACC,OAAO,CAAC,CAA+B;QACvDC,OAAO,EAAE,CAAC;YACRC,aAAa,EAAE,CAAC,GAAGV,aAAa,CAACW,MAAM;YACvC,EAA4C,AAA5C,0CAA4C;YAC5CC,OAAO,EAAE,KAAK;YACdC,GAAG,EA3BsB,YAAgB;YA4BzCC,MAAM,GAAGD,GAAW,EAAEE,CAAM,EAAEC,YAAoB,OA5BzB,YAAgB,iBA6BxBH,GAAG,EAAEG,YAAY;QACpC,CAAC;IACH,CAAC;IAED,EAAc,AAAd,YAAc;IACdf,OAAO,CAACE,IAAI,CAAC,CAAC;QACZG,MAAM,EAAEC,OAAO,CAACC,OAAO,CAAC,CAAmC;QAC3DC,OAAO,EAAE,CAAC;YACRQ,cAAc,EAAE,CAAC;gBAACC,OAAO,EAAEnB,cAAc;gBAAEoB,MAAM,EAAE,KAAK;YAAC,CAAC;QAC5D,CAAC;IACH,CAAC;IAEDlB,OAAO,CAACE,IAAI,CACV,EAAsE,AAAtE,oEAAsE;IACtE,EAA0B,AAA1B,wBAA0B;OACvBH,aAAa,CAACoB,KAAK,GAAGC,OAAO;IAGlC,MAAM,CAACpB,OAAO;AAChB,CAAC"}