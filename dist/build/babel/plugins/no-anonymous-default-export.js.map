{"version":3,"sources":["../../../../build/babel/plugins/no-anonymous-default-export.ts"],"sourcesContent":["import { PluginObj, types as BabelTypes } from 'next/dist/compiled/babel/core'\nimport chalk from 'chalk'\n\nexport default function NoAnonymousDefaultExport({\n  types: t,\n  ...babel\n}: {\n  types: typeof BabelTypes\n  caller: (callerCallback: (caller: any) => any) => any\n}): PluginObj<any> {\n  let onWarning: ((reason: string | Error) => void) | null = null\n  babel.caller((caller) => {\n    onWarning = caller.onWarning\n    return '' // Intentionally empty to not invalidate cache\n  })\n\n  if (typeof onWarning !== 'function') {\n    return { visitor: {} }\n  }\n\n  const warn: any = onWarning\n  return {\n    visitor: {\n      ExportDefaultDeclaration(path) {\n        const def = path.node.declaration\n\n        if (\n          !(\n            def.type === 'ArrowFunctionExpression' ||\n            def.type === 'FunctionDeclaration'\n          )\n        ) {\n          return\n        }\n\n        switch (def.type) {\n          case 'ArrowFunctionExpression': {\n            warn(\n              [\n                chalk.yellow.bold(\n                  'Anonymous arrow functions cause Fast Refresh to not preserve local component state.'\n                ),\n                'Please add a name to your function, for example:',\n                '',\n                chalk.bold('Before'),\n                chalk.cyan('export default () => <div />;'),\n                '',\n                chalk.bold('After'),\n                chalk.cyan('const Named = () => <div />;'),\n                chalk.cyan('export default Named;'),\n                '',\n                `A codemod is available to fix the most common cases: ${chalk.cyan(\n                  'https://nextjs.link/codemod-ndc'\n                )}`,\n              ].join('\\n')\n            )\n            break\n          }\n          case 'FunctionDeclaration': {\n            const isAnonymous = !Boolean(def.id)\n            if (isAnonymous) {\n              warn(\n                [\n                  chalk.yellow.bold(\n                    'Anonymous function declarations cause Fast Refresh to not preserve local component state.'\n                  ),\n                  'Please add a name to your function, for example:',\n                  '',\n                  chalk.bold('Before'),\n                  chalk.cyan('export default function () { /* ... */ }'),\n                  '',\n                  chalk.bold('After'),\n                  chalk.cyan('export default function Named() { /* ... */ }'),\n                  '',\n                  `A codemod is available to fix the most common cases: ${chalk.cyan(\n                    'https://nextjs.link/codemod-ndc'\n                  )}`,\n                ].join('\\n')\n              )\n            }\n            break\n          }\n          default: {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            const _: never = def\n          }\n        }\n      },\n    },\n  }\n}\n"],"names":["NoAnonymousDefaultExport","types","t","babel","onWarning","caller","visitor","warn","ExportDefaultDeclaration","path","def","node","declaration","type","yellow","bold","cyan","join","isAnonymous","Boolean","id","_"],"mappings":";;;;kBAGwBA,wBAAwB;AAF9B,GAAO,CAAP,MAAO;;;;;;SAEDA,wBAAwB,CAAC,CAAC,CAChDC,KAAK,EAAEC,CAAC,MACLC,KAAK,CAIV,CAAC,EAAkB,CAAC;IAClB,GAAG,CAACC,SAAS,GAA8C,IAAI;IAC/DD,KAAK,CAACE,MAAM,EAAEA,MAAM,GAAK,CAAC;QACxBD,SAAS,GAAGC,MAAM,CAACD,SAAS;QAC5B,MAAM,CAAC,CAAE,CAAC,CAA8C,AAA9C,EAA8C,AAA9C,4CAA8C;;IAC1D,CAAC;IAED,EAAE,EAAE,MAAM,CAACA,SAAS,KAAK,CAAU,WAAE,CAAC;QACpC,MAAM,CAAC,CAAC;YAACE,OAAO,EAAE,CAAC;YAAA,CAAC;QAAC,CAAC;IACxB,CAAC;IAED,KAAK,CAACC,IAAI,GAAQH,SAAS;IAC3B,MAAM,CAAC,CAAC;QACNE,OAAO,EAAE,CAAC;YACRE,wBAAwB,EAACC,IAAI,EAAE,CAAC;gBAC9B,KAAK,CAACC,GAAG,GAAGD,IAAI,CAACE,IAAI,CAACC,WAAW;gBAEjC,EAAE,IAEEF,GAAG,CAACG,IAAI,KAAK,CAAyB,4BACtCH,GAAG,CAACG,IAAI,KAAK,CAAqB,uBAEpC,CAAC;oBACD,MAAM;gBACR,CAAC;gBAED,MAAM,CAAEH,GAAG,CAACG,IAAI;oBACd,IAAI,CAAC,CAAyB;wBAAE,CAAC;4BAC/BN,IAAI,CACF,CAAC;gCArCG,MAAO,SAsCHO,MAAM,CAACC,IAAI,CACf,CAAqF;gCAEvF,CAAkD;gCAClD,CAAE;gCA1CA,MAAO,SA2CHA,IAAI,CAAC,CAAQ;gCA3CjB,MAAO,SA4CHC,IAAI,CAAC,CAA+B;gCAC1C,CAAE;gCA7CA,MAAO,SA8CHD,IAAI,CAAC,CAAO;gCA9ChB,MAAO,SA+CHC,IAAI,CAAC,CAA8B;gCA/CvC,MAAO,SAgDHA,IAAI,CAAC,CAAuB;gCAClC,CAAE;iCACD,qDAAqD,EAlDpD,MAAO,SAkDqDA,IAAI,CAChE,CAAiC;4BAErC,CAAC,CAACC,IAAI,CAAC,CAAI;4BAEb,KAAK;wBACP,CAAC;oBACD,IAAI,CAAC,CAAqB;wBAAE,CAAC;4BAC3B,KAAK,CAACC,WAAW,IAAIC,OAAO,CAACT,GAAG,CAACU,EAAE;4BACnC,EAAE,EAAEF,WAAW,EAAE,CAAC;gCAChBX,IAAI,CACF,CAAC;oCA7DC,MAAO,SA8DDO,MAAM,CAACC,IAAI,CACf,CAA2F;oCAE7F,CAAkD;oCAClD,CAAE;oCAlEF,MAAO,SAmEDA,IAAI,CAAC,CAAQ;oCAnEnB,MAAO,SAoEDC,IAAI,CAAC,CAA0C;oCACrD,CAAE;oCArEF,MAAO,SAsEDD,IAAI,CAAC,CAAO;oCAtElB,MAAO,SAuEDC,IAAI,CAAC,CAA+C;oCAC1D,CAAE;qCACD,qDAAqD,EAzEtD,MAAO,SAyEuDA,IAAI,CAChE,CAAiC;gCAErC,CAAC,CAACC,IAAI,CAAC,CAAI;4BAEf,CAAC;4BACD,KAAK;wBACP,CAAC;;wBACQ,CAAC;4BACR,EAA6D,AAA7D,2DAA6D;4BAC7D,KAAK,CAACI,CAAC,GAAUX,GAAG;wBACtB,CAAC;;YAEL,CAAC;QACH,CAAC;IACH,CAAC;AACH,CAAC"}