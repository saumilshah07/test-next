{"version":3,"sources":["../../client/route-announcer.tsx"],"sourcesContent":["import React from 'react'\nimport { useRouter } from './router'\n\nexport function RouteAnnouncer() {\n  const { asPath } = useRouter()\n  const [routeAnnouncement, setRouteAnnouncement] = React.useState('')\n\n  // Only announce the path change, but not for the first load because screen reader will do that automatically.\n  const initialPathLoaded = React.useRef(false)\n\n  // Every time the path changes, announce the route change. The announcement will be prioritized by h1, then title\n  // (from metadata), and finally if those don't exist, then the pathName that is in the URL. This methodology is\n  // inspired by Marcy Sutton's accessible client routing user testing. More information can be found here:\n  // https://www.gatsbyjs.com/blog/2019-07-11-user-testing-accessible-client-routing/\n  React.useEffect(\n    () => {\n      if (!initialPathLoaded.current) {\n        initialPathLoaded.current = true\n        return\n      }\n\n      let newRouteAnnouncement\n      const pageHeader = document.querySelector('h1')\n\n      if (pageHeader) {\n        newRouteAnnouncement = pageHeader.innerText || pageHeader.textContent\n      }\n      if (!newRouteAnnouncement) {\n        if (document.title) {\n          newRouteAnnouncement = document.title\n        } else {\n          newRouteAnnouncement = asPath\n        }\n      }\n\n      setRouteAnnouncement(newRouteAnnouncement)\n    },\n    // TODO: switch to pathname + query object of dynamic route requirements\n    [asPath]\n  )\n\n  return (\n    <p\n      aria-live=\"assertive\" // Make the announcement immediately.\n      id=\"__next-route-announcer__\"\n      role=\"alert\"\n      style={{\n        border: 0,\n        clip: 'rect(0 0 0 0)',\n        height: '1px',\n        margin: '-1px',\n        overflow: 'hidden',\n        padding: 0,\n        position: 'absolute',\n        width: '1px',\n\n        // https://medium.com/@jessebeach/beware-smushed-off-screen-accessible-text-5952a4c2cbfe\n        whiteSpace: 'nowrap',\n        wordWrap: 'normal',\n      }}\n    >\n      {routeAnnouncement}\n    </p>\n  )\n}\n\nexport default RouteAnnouncer\n"],"names":["RouteAnnouncer","asPath","routeAnnouncement","setRouteAnnouncement","useState","initialPathLoaded","useRef","useEffect","current","newRouteAnnouncement","pageHeader","document","querySelector","innerText","textContent","title","p","aria-live","id","role","style","border","clip","height","margin","overflow","padding","position","width","whiteSpace","wordWrap"],"mappings":";;;;QAGgBA,cAAc,GAAdA,cAAc;;AAHZ,GAAO,CAAP,MAAO;AACC,GAAU,CAAV,OAAU;;;;;;SAEpBA,cAAc,GAAG,CAAC;IAChC,KAAK,CAAC,CAAC,CAACC,MAAM,EAAC,CAAC,OAHQ,OAAU;IAIlC,KAAK,EAAEC,iBAAiB,EAAEC,oBAAoB,IAL9B,MAAO,SAKiCC,QAAQ,CAAC,CAAE;IAEnE,EAA8G,AAA9G,4GAA8G;IAC9G,KAAK,CAACC,iBAAiB,GARP,MAAO,SAQSC,MAAM,CAAC,KAAK;IAE5C,EAAiH,AAAjH,+GAAiH;IACjH,EAA+G,AAA/G,6GAA+G;IAC/G,EAAyG,AAAzG,uGAAyG;IACzG,EAAmF,AAAnF,iFAAmF;IAbnE,MAAO,SAcjBC,SAAS,KACP,CAAC;QACL,EAAE,GAAGF,iBAAiB,CAACG,OAAO,EAAE,CAAC;YAC/BH,iBAAiB,CAACG,OAAO,GAAG,IAAI;YAChC,MAAM;QACR,CAAC;QAED,GAAG,CAACC,oBAAoB;QACxB,KAAK,CAACC,UAAU,GAAGC,QAAQ,CAACC,aAAa,CAAC,CAAI;QAE9C,EAAE,EAAEF,UAAU,EAAE,CAAC;YACfD,oBAAoB,GAAGC,UAAU,CAACG,SAAS,IAAIH,UAAU,CAACI,WAAW;QACvE,CAAC;QACD,EAAE,GAAGL,oBAAoB,EAAE,CAAC;YAC1B,EAAE,EAAEE,QAAQ,CAACI,KAAK,EAAE,CAAC;gBACnBN,oBAAoB,GAAGE,QAAQ,CAACI,KAAK;YACvC,CAAC,MAAM,CAAC;gBACNN,oBAAoB,GAAGR,MAAM;YAC/B,CAAC;QACH,CAAC;QAEDE,oBAAoB,CAACM,oBAAoB;IAC3C,CAAC,EACD,EAAwE,AAAxE,sEAAwE;IACxE,CAACR;QAAAA,MAAM;IAAA,CAAC;IAGV,MAAM,eAzCU,MAAO,uBA0CpBe,CAAC;QACAC,CAAS,YAAC,CAAW,UAAC,CAAqC,AAArC,EAAqC,AAArC,mCAAqC;;QAC3DC,EAAE,EAAC,CAA0B;QAC7BC,IAAI,EAAC,CAAO;QACZC,KAAK,EAAE,CAAC;YACNC,MAAM,EAAE,CAAC;YACTC,IAAI,EAAE,CAAe;YACrBC,MAAM,EAAE,CAAK;YACbC,MAAM,EAAE,CAAM;YACdC,QAAQ,EAAE,CAAQ;YAClBC,OAAO,EAAE,CAAC;YACVC,QAAQ,EAAE,CAAU;YACpBC,KAAK,EAAE,CAAK;YAEZ,EAAwF,AAAxF,sFAAwF;YACxFC,UAAU,EAAE,CAAQ;YACpBC,QAAQ,EAAE,CAAQ;QACpB,CAAC;OAEA5B,iBAAiB;AAGxB,CAAC;eAEcF,cAAc"}