{"version":3,"sources":["../../../client/dev/on-demand-entries-client.js"],"sourcesContent":["import Router from 'next/router'\nimport { setupPing, currentPage, closePing } from './on-demand-entries-utils'\n\nexport default async ({ assetPrefix }) => {\n  Router.ready(() => {\n    Router.events.on(\n      'routeChangeComplete',\n      setupPing.bind(this, assetPrefix, () => Router.pathname)\n    )\n  })\n\n  setupPing(\n    assetPrefix,\n    () => Router.query.__NEXT_PAGE || Router.pathname,\n    currentPage\n  )\n\n  // prevent HMR connection from being closed when running tests\n  if (!process.env.__NEXT_TEST_MODE) {\n    document.addEventListener('visibilitychange', (_event) => {\n      const state = document.visibilityState\n      if (state === 'visible') {\n        setupPing(assetPrefix, () => Router.pathname, true)\n      } else {\n        closePing()\n      }\n    })\n\n    window.addEventListener('beforeunload', () => {\n      closePing()\n    })\n  }\n}\n"],"names":["assetPrefix","ready","events","on","bind","pathname","query","__NEXT_PAGE","process","env","__NEXT_TEST_MODE","document","addEventListener","_event","state","visibilityState","window"],"mappings":";;;;;AAAmB,GAAa,CAAb,OAAa;AACkB,GAA2B,CAA3B,qBAA2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kCAE9D,QAAQ,EAAD,CAAC,CAACA,WAAW,EAAC,CAAC,EAAK,CAAC;IAHxB,OAAa,SAIvBC,KAAK,KAAO,CAAC;QAJH,OAAa,SAKrBC,MAAM,CAACC,EAAE,CACd,CAAqB,sBALuB,qBAA2B,WAM7DC,IAAI,CAAC,IAAI,EAAEJ,WAAW,MAPnB,OAAa,SAOqBK,QAAQ;;IAE3D,CAAC;QAR+C,qBAA2B,YAWzEL,WAAW,MAZI,OAAa,SAafM,KAAK,CAACC,WAAW,IAbf,OAAa,SAaaF,QAAQ;MAZH,qBAA2B;IAgB3E,EAA8D,AAA9D,4DAA8D;IAC9D,EAAE,GAAGG,OAAO,CAACC,GAAG,CAACC,gBAAgB,EAAE,CAAC;QAClCC,QAAQ,CAACC,gBAAgB,CAAC,CAAkB,oBAAGC,MAAM,GAAK,CAAC;YACzD,KAAK,CAACC,KAAK,GAAGH,QAAQ,CAACI,eAAe;YACtC,EAAE,EAAED,KAAK,KAAK,CAAS,UAAE,CAAC;oBApBkB,qBAA2B,YAqB3Dd,WAAW,MAtBV,OAAa,SAsBYK,QAAQ;kBAAE,IAAI;YACpD,CAAC,MAAM,CAAC;oBAtBoC,qBAA2B;YAwBvE,CAAC;QACH,CAAC;QAEDW,MAAM,CAACJ,gBAAgB,CAAC,CAAc,mBAAQ,CAAC;gBA3BD,qBAA2B;QA6BzE,CAAC;IACH,CAAC;AACH,CAAC"}