{"version":3,"sources":["../../../../../server/lib/squoosh/png/squoosh_png.js"],"sourcesContent":["import { TextDecoder } from '../text-decoder'\n\nlet wasm\n\nlet cachedTextDecoder = new TextDecoder('utf-8', {\n  ignoreBOM: true,\n  fatal: true,\n})\n\ncachedTextDecoder.decode()\n\nlet cachegetUint8Memory0 = null\nfunction getUint8Memory0() {\n  if (\n    cachegetUint8Memory0 === null ||\n    cachegetUint8Memory0.buffer !== wasm.memory.buffer\n  ) {\n    cachegetUint8Memory0 = new Uint8Array(wasm.memory.buffer)\n  }\n  return cachegetUint8Memory0\n}\n\nfunction getStringFromWasm0(ptr, len) {\n  return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len))\n}\n\nlet cachegetUint8ClampedMemory0 = null\nfunction getUint8ClampedMemory0() {\n  if (\n    cachegetUint8ClampedMemory0 === null ||\n    cachegetUint8ClampedMemory0.buffer !== wasm.memory.buffer\n  ) {\n    cachegetUint8ClampedMemory0 = new Uint8ClampedArray(wasm.memory.buffer)\n  }\n  return cachegetUint8ClampedMemory0\n}\n\nfunction getClampedArrayU8FromWasm0(ptr, len) {\n  return getUint8ClampedMemory0().subarray(ptr / 1, ptr / 1 + len)\n}\n\nconst heap = new Array(32).fill(undefined)\n\nheap.push(undefined, null, true, false)\n\nlet heap_next = heap.length\n\nfunction addHeapObject(obj) {\n  if (heap_next === heap.length) heap.push(heap.length + 1)\n  const idx = heap_next\n  heap_next = heap[idx]\n\n  heap[idx] = obj\n  return idx\n}\n\nlet WASM_VECTOR_LEN = 0\n\nfunction passArray8ToWasm0(arg, malloc) {\n  const ptr = malloc(arg.length * 1)\n  getUint8Memory0().set(arg, ptr / 1)\n  WASM_VECTOR_LEN = arg.length\n  return ptr\n}\n\nlet cachegetInt32Memory0 = null\nfunction getInt32Memory0() {\n  if (\n    cachegetInt32Memory0 === null ||\n    cachegetInt32Memory0.buffer !== wasm.memory.buffer\n  ) {\n    cachegetInt32Memory0 = new Int32Array(wasm.memory.buffer)\n  }\n  return cachegetInt32Memory0\n}\n\nfunction getArrayU8FromWasm0(ptr, len) {\n  return getUint8Memory0().subarray(ptr / 1, ptr / 1 + len)\n}\n/**\n * @param {Uint8Array} data\n * @param {number} width\n * @param {number} height\n * @returns {Uint8Array}\n */\nexport function encode(data, width, height) {\n  try {\n    const retptr = wasm.__wbindgen_export_1.value - 16\n    wasm.__wbindgen_export_1.value = retptr\n    var ptr0 = passArray8ToWasm0(data, wasm.__wbindgen_malloc)\n    var len0 = WASM_VECTOR_LEN\n    wasm.encode(retptr, ptr0, len0, width, height)\n    var r0 = getInt32Memory0()[retptr / 4 + 0]\n    var r1 = getInt32Memory0()[retptr / 4 + 1]\n    var v1 = getArrayU8FromWasm0(r0, r1).slice()\n    wasm.__wbindgen_free(r0, r1 * 1)\n    return v1\n  } finally {\n    wasm.__wbindgen_export_1.value += 16\n  }\n}\n\nfunction getObject(idx) {\n  return heap[idx]\n}\n\nfunction dropObject(idx) {\n  if (idx < 36) return\n  heap[idx] = heap_next\n  heap_next = idx\n}\n\nfunction takeObject(idx) {\n  const ret = getObject(idx)\n  dropObject(idx)\n  return ret\n}\n/**\n * @param {Uint8Array} data\n * @returns {ImageData}\n */\nexport function decode(data) {\n  var ptr0 = passArray8ToWasm0(data, wasm.__wbindgen_malloc)\n  var len0 = WASM_VECTOR_LEN\n  var ret = wasm.decode(ptr0, len0)\n  return takeObject(ret)\n}\n\nasync function load(module, imports) {\n  if (typeof Response === 'function' && module instanceof Response) {\n    if (typeof WebAssembly.instantiateStreaming === 'function') {\n      try {\n        return await WebAssembly.instantiateStreaming(module, imports)\n      } catch (e) {\n        if (module.headers.get('Content-Type') !== 'application/wasm') {\n          console.warn(\n            '`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n',\n            e\n          )\n        } else {\n          throw e\n        }\n      }\n    }\n\n    const bytes = await module.arrayBuffer()\n    return await WebAssembly.instantiate(bytes, imports)\n  } else {\n    const instance = await WebAssembly.instantiate(module, imports)\n\n    if (instance instanceof WebAssembly.Instance) {\n      return { instance, module }\n    } else {\n      return instance\n    }\n  }\n}\n\nasync function init(input) {\n  if (typeof input === 'undefined') {\n    // input = import.meta.url.replace(/\\.js$/, '_bg.wasm')\n    throw new Error('invariant')\n  }\n  const imports = {}\n  imports.wbg = {}\n  imports.wbg.__wbg_newwithownedu8clampedarrayandsh_787b2db8ea6bfd62 =\n    function (arg0, arg1, arg2, arg3) {\n      var v0 = getClampedArrayU8FromWasm0(arg0, arg1).slice()\n      wasm.__wbindgen_free(arg0, arg1 * 1)\n      var ret = new ImageData(v0, arg2 >>> 0, arg3 >>> 0)\n      return addHeapObject(ret)\n    }\n  imports.wbg.__wbindgen_throw = function (arg0, arg1) {\n    throw new Error(getStringFromWasm0(arg0, arg1))\n  }\n  if (\n    typeof input === 'string' ||\n    (typeof Request === 'function' && input instanceof Request) ||\n    (typeof URL === 'function' && input instanceof URL)\n  ) {\n    input = fetch(input)\n  }\n\n  const { instance, module } = await load(await input, imports)\n\n  wasm = instance.exports\n  init.__wbindgen_wasm_module = module\n\n  return wasm\n}\n\nexport default init\n\n// Manually remove the wasm and memory references to trigger GC\nexport function cleanup() {\n  wasm = null\n  cachegetUint8ClampedMemory0 = null\n  cachegetUint8Memory0 = null\n  cachegetInt32Memory0 = null\n}\n"],"names":["encode","decode","cleanup","wasm","cachedTextDecoder","ignoreBOM","fatal","cachegetUint8Memory0","getUint8Memory0","buffer","memory","Uint8Array","getStringFromWasm0","ptr","len","subarray","cachegetUint8ClampedMemory0","getUint8ClampedMemory0","Uint8ClampedArray","getClampedArrayU8FromWasm0","heap","Array","fill","undefined","push","heap_next","length","addHeapObject","obj","idx","WASM_VECTOR_LEN","passArray8ToWasm0","arg","malloc","set","cachegetInt32Memory0","getInt32Memory0","Int32Array","getArrayU8FromWasm0","data","width","height","retptr","__wbindgen_export_1","value","ptr0","__wbindgen_malloc","len0","r0","r1","v1","slice","__wbindgen_free","getObject","dropObject","takeObject","ret","load","module","imports","Response","WebAssembly","instantiateStreaming","e","headers","get","console","warn","bytes","arrayBuffer","instantiate","instance","Instance","init","input","Error","wbg","__wbg_newwithownedu8clampedarrayandsh_787b2db8ea6bfd62","arg0","arg1","arg2","arg3","v0","ImageData","__wbindgen_throw","Request","URL","fetch","exports","__wbindgen_wasm_module"],"mappings":";;;;QAqFgBA,MAAM,GAANA,MAAM;QAoCNC,MAAM,GAANA,MAAM;QAyENC,OAAO,GAAPA,OAAO;;AAlMK,GAAiB,CAAjB,YAAiB;AAE7C,GAAG,CAACC,IAAI;AAER,GAAG,CAACC,iBAAiB,GAAG,GAAG,CAJC,YAAiB,aAIL,CAAO,QAAE,CAAC;IAChDC,SAAS,EAAE,IAAI;IACfC,KAAK,EAAE,IAAI;AACb,CAAC;AAEDF,iBAAiB,CAACH,MAAM;AAExB,GAAG,CAACM,oBAAoB,GAAG,IAAI;SACtBC,eAAe,GAAG,CAAC;IAC1B,EAAE,EACAD,oBAAoB,KAAK,IAAI,IAC7BA,oBAAoB,CAACE,MAAM,KAAKN,IAAI,CAACO,MAAM,CAACD,MAAM,EAClD,CAAC;QACDF,oBAAoB,GAAG,GAAG,CAACI,UAAU,CAACR,IAAI,CAACO,MAAM,CAACD,MAAM;IAC1D,CAAC;IACD,MAAM,CAACF,oBAAoB;AAC7B,CAAC;SAEQK,kBAAkB,CAACC,GAAG,EAAEC,GAAG,EAAE,CAAC;IACrC,MAAM,CAACV,iBAAiB,CAACH,MAAM,CAACO,eAAe,GAAGO,QAAQ,CAACF,GAAG,EAAEA,GAAG,GAAGC,GAAG;AAC3E,CAAC;AAED,GAAG,CAACE,2BAA2B,GAAG,IAAI;SAC7BC,sBAAsB,GAAG,CAAC;IACjC,EAAE,EACAD,2BAA2B,KAAK,IAAI,IACpCA,2BAA2B,CAACP,MAAM,KAAKN,IAAI,CAACO,MAAM,CAACD,MAAM,EACzD,CAAC;QACDO,2BAA2B,GAAG,GAAG,CAACE,iBAAiB,CAACf,IAAI,CAACO,MAAM,CAACD,MAAM;IACxE,CAAC;IACD,MAAM,CAACO,2BAA2B;AACpC,CAAC;SAEQG,0BAA0B,CAACN,GAAG,EAAEC,GAAG,EAAE,CAAC;IAC7C,MAAM,CAACG,sBAAsB,GAAGF,QAAQ,CAACF,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG,CAAC,GAAGC,GAAG;AACjE,CAAC;AAED,KAAK,CAACM,IAAI,GAAG,GAAG,CAACC,KAAK,CAAC,EAAE,EAAEC,IAAI,CAACC,SAAS;AAEzCH,IAAI,CAACI,IAAI,CAACD,SAAS,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK;AAEtC,GAAG,CAACE,SAAS,GAAGL,IAAI,CAACM,MAAM;SAElBC,aAAa,CAACC,GAAG,EAAE,CAAC;IAC3B,EAAE,EAAEH,SAAS,KAAKL,IAAI,CAACM,MAAM,EAAEN,IAAI,CAACI,IAAI,CAACJ,IAAI,CAACM,MAAM,GAAG,CAAC;IACxD,KAAK,CAACG,GAAG,GAAGJ,SAAS;IACrBA,SAAS,GAAGL,IAAI,CAACS,GAAG;IAEpBT,IAAI,CAACS,GAAG,IAAID,GAAG;IACf,MAAM,CAACC,GAAG;AACZ,CAAC;AAED,GAAG,CAACC,eAAe,GAAG,CAAC;SAEdC,iBAAiB,CAACC,GAAG,EAAEC,MAAM,EAAE,CAAC;IACvC,KAAK,CAACpB,GAAG,GAAGoB,MAAM,CAACD,GAAG,CAACN,MAAM,GAAG,CAAC;IACjClB,eAAe,GAAG0B,GAAG,CAACF,GAAG,EAAEnB,GAAG,GAAG,CAAC;IAClCiB,eAAe,GAAGE,GAAG,CAACN,MAAM;IAC5B,MAAM,CAACb,GAAG;AACZ,CAAC;AAED,GAAG,CAACsB,oBAAoB,GAAG,IAAI;SACtBC,eAAe,GAAG,CAAC;IAC1B,EAAE,EACAD,oBAAoB,KAAK,IAAI,IAC7BA,oBAAoB,CAAC1B,MAAM,KAAKN,IAAI,CAACO,MAAM,CAACD,MAAM,EAClD,CAAC;QACD0B,oBAAoB,GAAG,GAAG,CAACE,UAAU,CAAClC,IAAI,CAACO,MAAM,CAACD,MAAM;IAC1D,CAAC;IACD,MAAM,CAAC0B,oBAAoB;AAC7B,CAAC;SAEQG,mBAAmB,CAACzB,GAAG,EAAEC,GAAG,EAAE,CAAC;IACtC,MAAM,CAACN,eAAe,GAAGO,QAAQ,CAACF,GAAG,GAAG,CAAC,EAAEA,GAAG,GAAG,CAAC,GAAGC,GAAG;AAC1D,CAAC;SAOed,MAAM,CAACuC,IAAI,EAAEC,KAAK,EAAEC,MAAM,EAAE,CAAC;IAC3C,GAAG,CAAC,CAAC;QACH,KAAK,CAACC,MAAM,GAAGvC,IAAI,CAACwC,mBAAmB,CAACC,KAAK,GAAG,EAAE;QAClDzC,IAAI,CAACwC,mBAAmB,CAACC,KAAK,GAAGF,MAAM;QACvC,GAAG,CAACG,IAAI,GAAGd,iBAAiB,CAACQ,IAAI,EAAEpC,IAAI,CAAC2C,iBAAiB;QACzD,GAAG,CAACC,IAAI,GAAGjB,eAAe;QAC1B3B,IAAI,CAACH,MAAM,CAAC0C,MAAM,EAAEG,IAAI,EAAEE,IAAI,EAAEP,KAAK,EAAEC,MAAM;QAC7C,GAAG,CAACO,EAAE,GAAGZ,eAAe,GAAGM,MAAM,GAAG,CAAC,GAAG,CAAC;QACzC,GAAG,CAACO,EAAE,GAAGb,eAAe,GAAGM,MAAM,GAAG,CAAC,GAAG,CAAC;QACzC,GAAG,CAACQ,EAAE,GAAGZ,mBAAmB,CAACU,EAAE,EAAEC,EAAE,EAAEE,KAAK;QAC1ChD,IAAI,CAACiD,eAAe,CAACJ,EAAE,EAAEC,EAAE,GAAG,CAAC;QAC/B,MAAM,CAACC,EAAE;IACX,CAAC,QAAS,CAAC;QACT/C,IAAI,CAACwC,mBAAmB,CAACC,KAAK,IAAI,EAAE;IACtC,CAAC;AACH,CAAC;SAEQS,SAAS,CAACxB,GAAG,EAAE,CAAC;IACvB,MAAM,CAACT,IAAI,CAACS,GAAG;AACjB,CAAC;SAEQyB,UAAU,CAACzB,GAAG,EAAE,CAAC;IACxB,EAAE,EAAEA,GAAG,GAAG,EAAE,EAAE,MAAM;IACpBT,IAAI,CAACS,GAAG,IAAIJ,SAAS;IACrBA,SAAS,GAAGI,GAAG;AACjB,CAAC;SAEQ0B,UAAU,CAAC1B,GAAG,EAAE,CAAC;IACxB,KAAK,CAAC2B,GAAG,GAAGH,SAAS,CAACxB,GAAG;IACzByB,UAAU,CAACzB,GAAG;IACd,MAAM,CAAC2B,GAAG;AACZ,CAAC;SAKevD,MAAM,CAACsC,IAAI,EAAE,CAAC;IAC5B,GAAG,CAACM,IAAI,GAAGd,iBAAiB,CAACQ,IAAI,EAAEpC,IAAI,CAAC2C,iBAAiB;IACzD,GAAG,CAACC,IAAI,GAAGjB,eAAe;IAC1B,GAAG,CAAC0B,GAAG,GAAGrD,IAAI,CAACF,MAAM,CAAC4C,IAAI,EAAEE,IAAI;IAChC,MAAM,CAACQ,UAAU,CAACC,GAAG;AACvB,CAAC;eAEcC,IAAI,CAACC,MAAM,EAAEC,OAAO,EAAE,CAAC;IACpC,EAAE,EAAE,MAAM,CAACC,QAAQ,KAAK,CAAU,aAAIF,MAAM,YAAYE,QAAQ,EAAE,CAAC;QACjE,EAAE,EAAE,MAAM,CAACC,WAAW,CAACC,oBAAoB,KAAK,CAAU,WAAE,CAAC;YAC3D,GAAG,CAAC,CAAC;gBACH,MAAM,CAAC,KAAK,CAACD,WAAW,CAACC,oBAAoB,CAACJ,MAAM,EAAEC,OAAO;YAC/D,CAAC,CAAC,KAAK,EAAEI,CAAC,EAAE,CAAC;gBACX,EAAE,EAAEL,MAAM,CAACM,OAAO,CAACC,GAAG,CAAC,CAAc,mBAAM,CAAkB,mBAAE,CAAC;oBAC9DC,OAAO,CAACC,IAAI,CACV,CAAmM,oMACnMJ,CAAC;gBAEL,CAAC,MAAM,CAAC;oBACN,KAAK,CAACA,CAAC;gBACT,CAAC;YACH,CAAC;QACH,CAAC;QAED,KAAK,CAACK,KAAK,GAAG,KAAK,CAACV,MAAM,CAACW,WAAW;QACtC,MAAM,CAAC,KAAK,CAACR,WAAW,CAACS,WAAW,CAACF,KAAK,EAAET,OAAO;IACrD,CAAC,MAAM,CAAC;QACN,KAAK,CAACY,QAAQ,GAAG,KAAK,CAACV,WAAW,CAACS,WAAW,CAACZ,MAAM,EAAEC,OAAO;QAE9D,EAAE,EAAEY,QAAQ,YAAYV,WAAW,CAACW,QAAQ,EAAE,CAAC;YAC7C,MAAM,CAAC,CAAC;gBAACD,QAAQ;gBAAEb,MAAM;YAAC,CAAC;QAC7B,CAAC,MAAM,CAAC;YACN,MAAM,CAACa,QAAQ;QACjB,CAAC;IACH,CAAC;AACH,CAAC;eAEcE,IAAI,CAACC,KAAK,EAAE,CAAC;IAC1B,EAAE,EAAE,MAAM,CAACA,KAAK,KAAK,CAAW,YAAE,CAAC;QACjC,EAAuD,AAAvD,qDAAuD;QACvD,KAAK,CAAC,GAAG,CAACC,KAAK,CAAC,CAAW;IAC7B,CAAC;IACD,KAAK,CAAChB,OAAO,GAAG,CAAC;IAAA,CAAC;IAClBA,OAAO,CAACiB,GAAG,GAAG,CAAC;IAAA,CAAC;IAChBjB,OAAO,CAACiB,GAAG,CAACC,sDAAsD,GAChE,QAAQ,CAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAEC,IAAI,EAAE,CAAC;QACjC,GAAG,CAACC,EAAE,GAAG/D,0BAA0B,CAAC2D,IAAI,EAAEC,IAAI,EAAE5B,KAAK;QACrDhD,IAAI,CAACiD,eAAe,CAAC0B,IAAI,EAAEC,IAAI,GAAG,CAAC;QACnC,GAAG,CAACvB,GAAG,GAAG,GAAG,CAAC2B,SAAS,CAACD,EAAE,EAAEF,IAAI,KAAK,CAAC,EAAEC,IAAI,KAAK,CAAC;QAClD,MAAM,CAACtD,aAAa,CAAC6B,GAAG;IAC1B,CAAC;IACHG,OAAO,CAACiB,GAAG,CAACQ,gBAAgB,GAAG,QAAQ,CAAEN,IAAI,EAAEC,IAAI,EAAE,CAAC;QACpD,KAAK,CAAC,GAAG,CAACJ,KAAK,CAAC/D,kBAAkB,CAACkE,IAAI,EAAEC,IAAI;IAC/C,CAAC;IACD,EAAE,EACA,MAAM,CAACL,KAAK,KAAK,CAAQ,WACxB,MAAM,CAACW,OAAO,KAAK,CAAU,aAAIX,KAAK,YAAYW,OAAO,IACzD,MAAM,CAACC,GAAG,KAAK,CAAU,aAAIZ,KAAK,YAAYY,GAAG,EAClD,CAAC;QACDZ,KAAK,GAAGa,KAAK,CAACb,KAAK;IACrB,CAAC;IAED,KAAK,CAAC,CAAC,CAACH,QAAQ,GAAEb,MAAM,EAAC,CAAC,GAAG,KAAK,CAACD,IAAI,CAAC,KAAK,CAACiB,KAAK,EAAEf,OAAO;IAE5DxD,IAAI,GAAGoE,QAAQ,CAACiB,OAAO;IACvBf,IAAI,CAACgB,sBAAsB,GAAG/B,MAAM;IAEpC,MAAM,CAACvD,IAAI;AACb,CAAC;eAEcsE,IAAI;;SAGHvE,OAAO,GAAG,CAAC;IACzBC,IAAI,GAAG,IAAI;IACXa,2BAA2B,GAAG,IAAI;IAClCT,oBAAoB,GAAG,IAAI;IAC3B4B,oBAAoB,GAAG,IAAI;AAC7B,CAAC"}