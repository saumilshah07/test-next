{"version":3,"sources":["../../../../../server/lib/squoosh/resize/squoosh_resize.js"],"sourcesContent":["let wasm\n\nlet cachegetUint8Memory0 = null\nfunction getUint8Memory0() {\n  if (\n    cachegetUint8Memory0 === null ||\n    cachegetUint8Memory0.buffer !== wasm.memory.buffer\n  ) {\n    cachegetUint8Memory0 = new Uint8Array(wasm.memory.buffer)\n  }\n  return cachegetUint8Memory0\n}\n\nlet WASM_VECTOR_LEN = 0\n\nfunction passArray8ToWasm0(arg, malloc) {\n  const ptr = malloc(arg.length * 1)\n  getUint8Memory0().set(arg, ptr / 1)\n  WASM_VECTOR_LEN = arg.length\n  return ptr\n}\n\nlet cachegetInt32Memory0 = null\nfunction getInt32Memory0() {\n  if (\n    cachegetInt32Memory0 === null ||\n    cachegetInt32Memory0.buffer !== wasm.memory.buffer\n  ) {\n    cachegetInt32Memory0 = new Int32Array(wasm.memory.buffer)\n  }\n  return cachegetInt32Memory0\n}\n\nfunction getArrayU8FromWasm0(ptr, len) {\n  return getUint8Memory0().subarray(ptr / 1, ptr / 1 + len)\n}\n/**\n * @param {Uint8Array} input_image\n * @param {number} input_width\n * @param {number} input_height\n * @param {number} output_width\n * @param {number} output_height\n * @param {number} typ_idx\n * @param {boolean} premultiply\n * @param {boolean} color_space_conversion\n * @returns {Uint8Array}\n */\nexport function resize(\n  input_image,\n  input_width,\n  input_height,\n  output_width,\n  output_height,\n  typ_idx,\n  premultiply,\n  color_space_conversion\n) {\n  var ptr0 = passArray8ToWasm0(input_image, wasm.__wbindgen_malloc)\n  var len0 = WASM_VECTOR_LEN\n  wasm.resize(\n    8,\n    ptr0,\n    len0,\n    input_width,\n    input_height,\n    output_width,\n    output_height,\n    typ_idx,\n    premultiply,\n    color_space_conversion\n  )\n  var r0 = getInt32Memory0()[8 / 4 + 0]\n  var r1 = getInt32Memory0()[8 / 4 + 1]\n  var v1 = getArrayU8FromWasm0(r0, r1).slice()\n  wasm.__wbindgen_free(r0, r1 * 1)\n  return v1\n}\n\nasync function load(module, imports) {\n  if (typeof Response === 'function' && module instanceof Response) {\n    if (typeof WebAssembly.instantiateStreaming === 'function') {\n      try {\n        return await WebAssembly.instantiateStreaming(module, imports)\n      } catch (e) {\n        if (module.headers.get('Content-Type') !== 'application/wasm') {\n          console.warn(\n            '`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n',\n            e\n          )\n        } else {\n          throw e\n        }\n      }\n    }\n\n    const bytes = await module.arrayBuffer()\n    return await WebAssembly.instantiate(bytes, imports)\n  } else {\n    const instance = await WebAssembly.instantiate(module, imports)\n\n    if (instance instanceof WebAssembly.Instance) {\n      return { instance, module }\n    } else {\n      return instance\n    }\n  }\n}\n\nasync function init(input) {\n  if (typeof input === 'undefined') {\n    // input = import.meta.url.replace(/\\.js$/, '_bg.wasm')\n    throw new Error('invariant')\n  }\n  const imports = {}\n\n  if (\n    typeof input === 'string' ||\n    (typeof Request === 'function' && input instanceof Request) ||\n    (typeof URL === 'function' && input instanceof URL)\n  ) {\n    input = fetch(input)\n  }\n\n  const { instance, module } = await load(await input, imports)\n\n  wasm = instance.exports\n  init.__wbindgen_wasm_module = module\n\n  return wasm\n}\n\nexport default init\n\n// Manually remove the wasm and memory references to trigger GC\nexport function cleanup() {\n  wasm = null\n  cachegetUint8Memory0 = null\n  cachegetInt32Memory0 = null\n}\n"],"names":["resize","cleanup","wasm","cachegetUint8Memory0","getUint8Memory0","buffer","memory","Uint8Array","WASM_VECTOR_LEN","passArray8ToWasm0","arg","malloc","ptr","length","set","cachegetInt32Memory0","getInt32Memory0","Int32Array","getArrayU8FromWasm0","len","subarray","input_image","input_width","input_height","output_width","output_height","typ_idx","premultiply","color_space_conversion","ptr0","__wbindgen_malloc","len0","r0","r1","v1","slice","__wbindgen_free","load","module","imports","Response","WebAssembly","instantiateStreaming","e","headers","get","console","warn","bytes","arrayBuffer","instantiate","instance","Instance","init","input","Error","Request","URL","fetch","exports","__wbindgen_wasm_module"],"mappings":"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"}