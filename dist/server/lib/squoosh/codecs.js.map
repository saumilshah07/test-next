{"version":3,"sources":["../../../../server/lib/squoosh/codecs.ts"],"sourcesContent":["import { promises as fsp } from 'fs'\nimport * as path from 'path'\nimport { instantiateEmscriptenWasm, pathify } from './emscripten-utils.js'\n\n// MozJPEG\n// @ts-ignore\nimport mozEnc from './mozjpeg/mozjpeg_node_enc.js'\nconst mozEncWasm = path.resolve(__dirname, './mozjpeg/mozjpeg_node_enc.wasm')\n// @ts-ignore\nimport mozDec from './mozjpeg/mozjpeg_node_dec.js'\nconst mozDecWasm = path.resolve(__dirname, './mozjpeg/mozjpeg_node_dec.wasm')\n\n// WebP\n// @ts-ignore\nimport webpEnc from './webp/webp_node_enc.js'\nconst webpEncWasm = path.resolve(__dirname, './webp/webp_node_enc.wasm')\n// @ts-ignore\nimport webpDec from './webp/webp_node_dec.js'\nconst webpDecWasm = path.resolve(__dirname, './webp/webp_node_dec.wasm')\n\n// PNG\n// @ts-ignore\nimport * as pngEncDec from './png/squoosh_png.js'\nconst pngEncDecWasm = path.resolve(__dirname, './png/squoosh_png_bg.wasm')\nconst pngEncDecInit = () =>\n  pngEncDec.default(fsp.readFile(pathify(pngEncDecWasm)))\n\n// OxiPNG\n// @ts-ignore\nimport * as oxipng from './png/squoosh_oxipng.js'\nconst oxipngWasm = path.resolve(__dirname, './png/squoosh_oxipng_bg.wasm')\nconst oxipngInit = () => oxipng.default(fsp.readFile(pathify(oxipngWasm)))\n\n// Resize\n// @ts-ignore\nimport * as resize from './resize/squoosh_resize.js'\nconst resizeWasm = path.resolve(__dirname, './resize/squoosh_resize_bg.wasm')\nconst resizeInit = () => resize.default(fsp.readFile(pathify(resizeWasm)))\n\n// rotate\nconst rotateWasm = path.resolve(__dirname, './rotate/rotate.wasm')\n\nimport ImageData from './image_data.js'\n;(global as any).ImageData = ImageData // mandatory for wasm binaries\n\nfunction resizeNameToIndex(\n  name: 'triangle' | 'catrom' | 'mitchell' | 'lanczos3'\n) {\n  switch (name) {\n    case 'triangle':\n      return 0\n    case 'catrom':\n      return 1\n    case 'mitchell':\n      return 2\n    case 'lanczos3':\n      return 3\n    default:\n      throw Error(`Unknown resize algorithm \"${name}\"`)\n  }\n}\n\nfunction resizeWithAspect({\n  input_width,\n  input_height,\n  target_width,\n  target_height,\n}: {\n  input_width: number\n  input_height: number\n  target_width?: number\n  target_height?: number\n}): { width: number; height: number } {\n  if (!target_width && !target_height) {\n    throw Error('Need to specify at least width or height when resizing')\n  }\n  if (target_width && target_height) {\n    return { width: target_width, height: target_height }\n  }\n  if (!target_width) {\n    return {\n      width: Math.round((input_width / input_height) * target_height!),\n      height: target_height!,\n    }\n  }\n  if (!target_height) {\n    return {\n      width: target_width,\n      height: Math.round((input_height / input_width) * target_width),\n    }\n  }\n  throw Error('invariant')\n}\n\nexport const preprocessors = {\n  resize: {\n    name: 'Resize',\n    description: 'Resize the image before compressing',\n    instantiate: async () => {\n      await resizeInit()\n      return (\n        buffer: Buffer | Uint8Array,\n        input_width: number,\n        input_height: number,\n        {\n          width,\n          height,\n          method,\n          premultiply,\n          linearRGB,\n        }: {\n          width?: number\n          height?: number\n          method: 'triangle' | 'catrom' | 'mitchell' | 'lanczos3'\n          premultiply: boolean\n          linearRGB: boolean\n        }\n      ) => {\n        ;({ width, height } = resizeWithAspect({\n          input_width,\n          input_height,\n          target_width: width,\n          target_height: height,\n        }))\n        const imageData = new ImageData(\n          resize.resize(\n            buffer,\n            input_width,\n            input_height,\n            width,\n            height,\n            resizeNameToIndex(method),\n            premultiply,\n            linearRGB\n          ),\n          width,\n          height\n        )\n        resize.cleanup()\n        return imageData\n      }\n    },\n    defaultOptions: {\n      method: 'lanczos3',\n      fitMethod: 'stretch',\n      premultiply: true,\n      linearRGB: true,\n    },\n  },\n  rotate: {\n    name: 'Rotate',\n    description: 'Rotate image',\n    instantiate: async () => {\n      return async (\n        buffer: Buffer | Uint8Array,\n        width: number,\n        height: number,\n        { numRotations }: { numRotations: number }\n      ) => {\n        const degrees = (numRotations * 90) % 360\n        const sameDimensions = degrees === 0 || degrees === 180\n        const size = width * height * 4\n        const { instance } = await WebAssembly.instantiate(\n          await fsp.readFile(pathify(rotateWasm))\n        )\n        const exports = instance.exports as any\n        const { memory } = exports\n        const additionalPagesNeeded = Math.ceil(\n          (size * 2 - memory.buffer.byteLength + 8) / (64 * 1024)\n        )\n        if (additionalPagesNeeded > 0) {\n          memory.grow(additionalPagesNeeded)\n        }\n        const view = new Uint8ClampedArray(memory.buffer)\n        view.set(buffer, 8)\n        exports.rotate(width, height, degrees)\n        return new ImageData(\n          Buffer.from(view.slice(size + 8, size * 2 + 8)),\n          sameDimensions ? width : height,\n          sameDimensions ? height : width\n        )\n      }\n    },\n    defaultOptions: {\n      numRotations: 0,\n    },\n  },\n} as const\n\nexport const codecs = {\n  mozjpeg: {\n    name: 'MozJPEG',\n    extension: 'jpg',\n    detectors: [/^\\xFF\\xD8\\xFF/],\n    dec: () => instantiateEmscriptenWasm(mozDec, mozDecWasm),\n    enc: () => instantiateEmscriptenWasm(mozEnc, mozEncWasm),\n    defaultEncoderOptions: {\n      quality: 75,\n      baseline: false,\n      arithmetic: false,\n      progressive: true,\n      optimize_coding: true,\n      smoothing: 0,\n      color_space: 3 /*YCbCr*/,\n      quant_table: 3,\n      trellis_multipass: false,\n      trellis_opt_zero: false,\n      trellis_opt_table: false,\n      trellis_loops: 1,\n      auto_subsample: true,\n      chroma_subsample: 2,\n      separate_chroma_quality: false,\n      chroma_quality: 75,\n    },\n    autoOptimize: {\n      option: 'quality',\n      min: 0,\n      max: 100,\n    },\n  },\n  webp: {\n    name: 'WebP',\n    extension: 'webp',\n    detectors: [/^RIFF....WEBPVP8[LX ]/],\n    dec: () => instantiateEmscriptenWasm(webpDec, webpDecWasm),\n    enc: () => instantiateEmscriptenWasm(webpEnc, webpEncWasm),\n    defaultEncoderOptions: {\n      quality: 75,\n      target_size: 0,\n      target_PSNR: 0,\n      method: 4,\n      sns_strength: 50,\n      filter_strength: 60,\n      filter_sharpness: 0,\n      filter_type: 1,\n      partitions: 0,\n      segments: 4,\n      pass: 1,\n      show_compressed: 0,\n      preprocessing: 0,\n      autofilter: 0,\n      partition_limit: 0,\n      alpha_compression: 1,\n      alpha_filtering: 1,\n      alpha_quality: 100,\n      lossless: 0,\n      exact: 0,\n      image_hint: 0,\n      emulate_jpeg_size: 0,\n      thread_level: 0,\n      low_memory: 0,\n      near_lossless: 100,\n      use_delta_palette: 0,\n      use_sharp_yuv: 0,\n    },\n    autoOptimize: {\n      option: 'quality',\n      min: 0,\n      max: 100,\n    },\n  },\n  oxipng: {\n    name: 'OxiPNG',\n    extension: 'png',\n    // eslint-disable-next-line no-control-regex\n    detectors: [/^\\x89PNG\\x0D\\x0A\\x1A\\x0A/],\n    dec: async () => {\n      await pngEncDecInit()\n      return {\n        decode: (buffer: Buffer | Uint8Array): Buffer => {\n          const imageData = pngEncDec.decode(buffer)\n          pngEncDec.cleanup()\n          return imageData\n        },\n      } as any\n    },\n    enc: async () => {\n      await pngEncDecInit()\n      await oxipngInit()\n      return {\n        encode: (\n          buffer: Buffer | Uint8Array,\n          width: number,\n          height: number,\n          opts: any\n        ) => {\n          const simplePng = pngEncDec.encode(\n            new Uint8Array(buffer),\n            width,\n            height\n          )\n          const imageData = oxipng.optimise(simplePng, opts.level)\n          oxipng.cleanup()\n          return imageData\n        },\n      }\n    },\n    defaultEncoderOptions: {\n      level: 2,\n    },\n    autoOptimize: {\n      option: 'level',\n      min: 6,\n      max: 1,\n    },\n  },\n} as const\n"],"names":["path","pngEncDec","oxipng","resize","mozEncWasm","resolve","__dirname","mozDecWasm","webpEncWasm","webpDecWasm","pngEncDecWasm","pngEncDecInit","default","readFile","oxipngWasm","oxipngInit","resizeWasm","resizeInit","rotateWasm","global","ImageData","resizeNameToIndex","name","Error","resizeWithAspect","input_width","input_height","target_width","target_height","width","height","Math","round","preprocessors","description","instantiate","buffer","method","premultiply","linearRGB","imageData","cleanup","defaultOptions","fitMethod","rotate","numRotations","degrees","sameDimensions","size","instance","WebAssembly","exports","memory","additionalPagesNeeded","ceil","byteLength","grow","view","Uint8ClampedArray","set","Buffer","from","slice","codecs","mozjpeg","extension","detectors","dec","enc","defaultEncoderOptions","quality","baseline","arithmetic","progressive","optimize_coding","smoothing","color_space","quant_table","trellis_multipass","trellis_opt_zero","trellis_opt_table","trellis_loops","auto_subsample","chroma_subsample","separate_chroma_quality","chroma_quality","autoOptimize","option","min","max","webp","target_size","target_PSNR","sns_strength","filter_strength","filter_sharpness","filter_type","partitions","segments","pass","show_compressed","preprocessing","autofilter","partition_limit","alpha_compression","alpha_filtering","alpha_quality","lossless","exact","image_hint","emulate_jpeg_size","thread_level","low_memory","near_lossless","use_delta_palette","use_sharp_yuv","decode","encode","opts","simplePng","Uint8Array","optimise","level"],"mappings":"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"}