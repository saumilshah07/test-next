{"version":3,"sources":["../../../server/dev/hot-reloader.ts"],"sourcesContent":["import { getOverlayMiddleware } from '@next/react-dev-overlay/lib/middleware'\nimport { NextHandleFunction } from 'connect'\nimport { IncomingMessage, ServerResponse } from 'http'\nimport { WebpackHotMiddleware } from './hot-middleware'\nimport { join } from 'path'\nimport { UrlObject } from 'url'\nimport { webpack, isWebpack5 } from 'next/dist/compiled/webpack/webpack'\nimport { createEntrypoints, createPagesMapping } from '../../build/entries'\nimport { watchCompilers } from '../../build/output'\nimport getBaseWebpackConfig from '../../build/webpack-config'\nimport { API_ROUTE } from '../../lib/constants'\nimport { recursiveDelete } from '../../lib/recursive-delete'\nimport { BLOCKED_PAGES } from '../../shared/lib/constants'\nimport { __ApiPreviewProps } from '../api-utils'\nimport { route } from '../router'\nimport { findPageFile } from '../lib/find-page-file'\nimport onDemandEntryHandler, {\n  entries,\n  BUILDING,\n} from './on-demand-entry-handler'\nimport { denormalizePagePath, normalizePathSep } from '../normalize-page-path'\nimport getRouteFromEntrypoint from '../get-route-from-entrypoint'\nimport { isWriteable } from '../../build/is-writeable'\nimport { ClientPagesLoaderOptions } from '../../build/webpack/loaders/next-client-pages-loader'\nimport { stringify } from 'querystring'\nimport { difference } from '../../build/utils'\nimport { NextConfigComplete } from '../config-shared'\nimport { CustomRoutes } from '../../lib/load-custom-routes'\nimport { DecodeError } from '../../shared/lib/utils'\nimport { Span, trace } from '../../telemetry/trace'\n\nexport async function renderScriptError(\n  res: ServerResponse,\n  error: Error,\n  { verbose = true } = {}\n) {\n  // Asks CDNs and others to not to cache the errored page\n  res.setHeader(\n    'Cache-Control',\n    'no-cache, no-store, max-age=0, must-revalidate'\n  )\n\n  if ((error as any).code === 'ENOENT') {\n    res.statusCode = 404\n    res.end('404 - Not Found')\n    return\n  }\n\n  if (verbose) {\n    console.error(error.stack)\n  }\n  res.statusCode = 500\n  res.end('500 - Internal Error')\n}\n\nfunction addCorsSupport(req: IncomingMessage, res: ServerResponse) {\n  const isApiRoute = req.url!.match(API_ROUTE)\n  // API routes handle their own CORS headers\n  if (isApiRoute) {\n    return { preflight: false }\n  }\n\n  if (!req.headers.origin) {\n    return { preflight: false }\n  }\n\n  res.setHeader('Access-Control-Allow-Origin', req.headers.origin)\n  res.setHeader('Access-Control-Allow-Methods', 'OPTIONS, GET')\n  // Based on https://github.com/primus/access-control/blob/4cf1bc0e54b086c91e6aa44fb14966fa5ef7549c/index.js#L158\n  if (req.headers['access-control-request-headers']) {\n    res.setHeader(\n      'Access-Control-Allow-Headers',\n      req.headers['access-control-request-headers'] as string\n    )\n  }\n\n  if (req.method === 'OPTIONS') {\n    res.writeHead(200)\n    res.end()\n    return { preflight: true }\n  }\n\n  return { preflight: false }\n}\n\nconst matchNextPageBundleRequest = route(\n  '/_next/static/chunks/pages/:path*.js(\\\\.map|)'\n)\n\n// Recursively look up the issuer till it ends up at the root\nfunction findEntryModule(issuer: any): any {\n  if (issuer.issuer) {\n    return findEntryModule(issuer.issuer)\n  }\n\n  return issuer\n}\n\nfunction erroredPages(compilation: webpack.compilation.Compilation) {\n  const failedPages: { [page: string]: any[] } = {}\n  for (const error of compilation.errors) {\n    if (!error.origin) {\n      continue\n    }\n\n    const entryModule = findEntryModule(error.origin)\n    const { name } = entryModule\n    if (!name) {\n      continue\n    }\n\n    // Only pages have to be reloaded\n    const enhancedName = getRouteFromEntrypoint(name)\n\n    if (!enhancedName) {\n      continue\n    }\n\n    if (!failedPages[enhancedName]) {\n      failedPages[enhancedName] = []\n    }\n\n    failedPages[enhancedName].push(error)\n  }\n\n  return failedPages\n}\n\nexport default class HotReloader {\n  private dir: string\n  private buildId: string\n  private middlewares: any[]\n  private pagesDir: string\n  private webpackHotMiddleware: (NextHandleFunction & any) | null\n  private config: NextConfigComplete\n  private stats: webpack.Stats | null\n  public serverStats: webpack.Stats | null\n  private clientError: Error | null = null\n  private serverError: Error | null = null\n  private serverPrevDocumentHash: string | null\n  private prevChunkNames?: Set<any>\n  private onDemandEntries: any\n  private previewProps: __ApiPreviewProps\n  private watcher: any\n  private rewrites: CustomRoutes['rewrites']\n  private fallbackWatcher: any\n  private hotReloaderSpan: Span\n  public isWebpack5: any\n\n  constructor(\n    dir: string,\n    {\n      config,\n      pagesDir,\n      buildId,\n      previewProps,\n      rewrites,\n    }: {\n      config: NextConfigComplete\n      pagesDir: string\n      buildId: string\n      previewProps: __ApiPreviewProps\n      rewrites: CustomRoutes['rewrites']\n    }\n  ) {\n    this.buildId = buildId\n    this.dir = dir\n    this.middlewares = []\n    this.pagesDir = pagesDir\n    this.webpackHotMiddleware = null\n    this.stats = null\n    this.serverStats = null\n    this.serverPrevDocumentHash = null\n\n    this.config = config\n    this.previewProps = previewProps\n    this.rewrites = rewrites\n    this.isWebpack5 = isWebpack5\n    this.hotReloaderSpan = trace('hot-reloader')\n  }\n\n  public async run(\n    req: IncomingMessage,\n    res: ServerResponse,\n    parsedUrl: UrlObject\n  ): Promise<{ finished?: true }> {\n    // Usually CORS support is not needed for the hot-reloader (this is dev only feature)\n    // With when the app runs for multi-zones support behind a proxy,\n    // the current page is trying to access this URL via assetPrefix.\n    // That's when the CORS support is needed.\n    const { preflight } = addCorsSupport(req, res)\n    if (preflight) {\n      return {}\n    }\n\n    // When a request comes in that is a page bundle, e.g. /_next/static/<buildid>/pages/index.js\n    // we have to compile the page using on-demand-entries, this middleware will handle doing that\n    // by adding the page to on-demand-entries, waiting till it's done\n    // and then the bundle will be served like usual by the actual route in server/index.js\n    const handlePageBundleRequest = async (\n      pageBundleRes: ServerResponse,\n      parsedPageBundleUrl: UrlObject\n    ): Promise<{ finished?: true }> => {\n      const { pathname } = parsedPageBundleUrl\n      const params: { path: string[] } | null =\n        matchNextPageBundleRequest(pathname)\n      if (!params) {\n        return {}\n      }\n\n      let decodedPagePath: string\n\n      try {\n        decodedPagePath = `/${params.path\n          .map((param) => decodeURIComponent(param))\n          .join('/')}`\n      } catch (_) {\n        throw new DecodeError('failed to decode param')\n      }\n\n      const page = denormalizePagePath(decodedPagePath)\n\n      if (page === '/_error' || BLOCKED_PAGES.indexOf(page) === -1) {\n        try {\n          await this.ensurePage(page)\n        } catch (error) {\n          await renderScriptError(pageBundleRes, error)\n          return { finished: true }\n        }\n\n        const errors = await this.getCompilationErrors(page)\n        if (errors.length > 0) {\n          await renderScriptError(pageBundleRes, errors[0], { verbose: false })\n          return { finished: true }\n        }\n      }\n\n      return {}\n    }\n\n    const { finished } = await handlePageBundleRequest(res, parsedUrl)\n\n    for (const fn of this.middlewares) {\n      await new Promise<void>((resolve, reject) => {\n        fn(req, res, (err: Error) => {\n          if (err) return reject(err)\n          resolve()\n        })\n      })\n    }\n\n    return { finished }\n  }\n\n  private async clean(): Promise<void> {\n    return recursiveDelete(join(this.dir, this.config.distDir), /^cache/)\n  }\n\n  private async getWebpackConfig() {\n    const pagePaths = await Promise.all([\n      findPageFile(this.pagesDir, '/_app', this.config.pageExtensions),\n      findPageFile(this.pagesDir, '/_document', this.config.pageExtensions),\n    ])\n\n    const pages = createPagesMapping(\n      pagePaths.filter((i) => i !== null) as string[],\n      this.config.pageExtensions,\n      this.isWebpack5,\n      true\n    )\n    const entrypoints = createEntrypoints(\n      pages,\n      'server',\n      this.buildId,\n      this.previewProps,\n      this.config,\n      []\n    )\n\n    return Promise.all([\n      getBaseWebpackConfig(this.dir, {\n        dev: true,\n        isServer: false,\n        config: this.config,\n        buildId: this.buildId,\n        pagesDir: this.pagesDir,\n        rewrites: this.rewrites,\n        entrypoints: entrypoints.client,\n        runWebpackSpan: this.hotReloaderSpan,\n      }),\n      getBaseWebpackConfig(this.dir, {\n        dev: true,\n        isServer: true,\n        config: this.config,\n        buildId: this.buildId,\n        pagesDir: this.pagesDir,\n        rewrites: this.rewrites,\n        entrypoints: entrypoints.server,\n        runWebpackSpan: this.hotReloaderSpan,\n      }),\n    ])\n  }\n\n  public async buildFallbackError(): Promise<void> {\n    if (this.fallbackWatcher) return\n\n    const fallbackConfig = await getBaseWebpackConfig(this.dir, {\n      runWebpackSpan: this.hotReloaderSpan,\n      dev: true,\n      isServer: false,\n      config: this.config,\n      buildId: this.buildId,\n      pagesDir: this.pagesDir,\n      rewrites: {\n        beforeFiles: [],\n        afterFiles: [],\n        fallback: [],\n      },\n      isDevFallback: true,\n      entrypoints: createEntrypoints(\n        {\n          '/_app': 'next/dist/pages/_app',\n          '/_error': 'next/dist/pages/_error',\n        },\n        'server',\n        this.buildId,\n        this.previewProps,\n        this.config,\n        []\n      ).client,\n    })\n    const fallbackCompiler = webpack(fallbackConfig)\n\n    this.fallbackWatcher = await new Promise((resolve) => {\n      let bootedFallbackCompiler = false\n      fallbackCompiler.watch(\n        // @ts-ignore webpack supports an array of watchOptions when using a multiCompiler\n        fallbackConfig.watchOptions,\n        // Errors are handled separately\n        (_err: any) => {\n          if (!bootedFallbackCompiler) {\n            bootedFallbackCompiler = true\n            resolve(true)\n          }\n        }\n      )\n    })\n  }\n\n  public async start(): Promise<void> {\n    await this.clean()\n\n    const configs = await this.getWebpackConfig()\n\n    for (const config of configs) {\n      const defaultEntry = config.entry\n      config.entry = async (...args) => {\n        // @ts-ignore entry is always a functon\n        const entrypoints = await defaultEntry(...args)\n\n        const isClientCompilation = config.name === 'client'\n\n        await Promise.all(\n          Object.keys(entries).map(async (page) => {\n            if (isClientCompilation && page.match(API_ROUTE)) {\n              return\n            }\n            const { serverBundlePath, clientBundlePath, absolutePagePath } =\n              entries[page]\n            const pageExists = await isWriteable(absolutePagePath)\n            if (!pageExists) {\n              // page was removed\n              delete entries[page]\n              return\n            }\n\n            entries[page].status = BUILDING\n            const pageLoaderOpts: ClientPagesLoaderOptions = {\n              page,\n              absolutePagePath,\n            }\n\n            entrypoints[\n              isClientCompilation ? clientBundlePath : serverBundlePath\n            ] = isClientCompilation\n              ? `next-client-pages-loader?${stringify(pageLoaderOpts)}!`\n              : absolutePagePath\n          })\n        )\n\n        return entrypoints\n      }\n    }\n\n    const multiCompiler = webpack(configs)\n\n    watchCompilers(multiCompiler.compilers[0], multiCompiler.compilers[1])\n\n    // Watch for changes to client/server page files so we can tell when just\n    // the server file changes and trigger a reload for GS(S)P pages\n    const changedClientPages = new Set<string>()\n    const changedServerPages = new Set<string>()\n    const prevClientPageHashes = new Map<string, string>()\n    const prevServerPageHashes = new Map<string, string>()\n\n    const trackPageChanges =\n      (pageHashMap: Map<string, string>, changedItems: Set<string>) =>\n      (stats: webpack.compilation.Compilation) => {\n        stats.entrypoints.forEach((entry, key) => {\n          if (key.startsWith('pages/')) {\n            entry.chunks.forEach((chunk: any) => {\n              if (chunk.id === key) {\n                const prevHash = pageHashMap.get(key)\n\n                if (prevHash && prevHash !== chunk.hash) {\n                  changedItems.add(key)\n                }\n                pageHashMap.set(key, chunk.hash)\n              }\n            })\n          }\n        })\n      }\n\n    multiCompiler.compilers[0].hooks.emit.tap(\n      'NextjsHotReloaderForClient',\n      trackPageChanges(prevClientPageHashes, changedClientPages)\n    )\n    multiCompiler.compilers[1].hooks.emit.tap(\n      'NextjsHotReloaderForServer',\n      trackPageChanges(prevServerPageHashes, changedServerPages)\n    )\n\n    // This plugin watches for changes to _document.js and notifies the client side that it should reload the page\n    multiCompiler.compilers[1].hooks.failed.tap(\n      'NextjsHotReloaderForServer',\n      (err: Error) => {\n        this.serverError = err\n        this.serverStats = null\n      }\n    )\n    multiCompiler.compilers[1].hooks.done.tap(\n      'NextjsHotReloaderForServer',\n      (stats) => {\n        this.serverError = null\n        this.serverStats = stats\n\n        const serverOnlyChanges = difference<string>(\n          changedServerPages,\n          changedClientPages\n        )\n        changedClientPages.clear()\n        changedServerPages.clear()\n\n        if (serverOnlyChanges.length > 0) {\n          this.send({\n            event: 'serverOnlyChanges',\n            pages: serverOnlyChanges.map((pg) =>\n              denormalizePagePath(pg.substr('pages'.length))\n            ),\n          })\n        }\n\n        const { compilation } = stats\n\n        // We only watch `_document` for changes on the server compilation\n        // the rest of the files will be triggered by the client compilation\n        const documentChunk = compilation.namedChunks.get('pages/_document')\n        // If the document chunk can't be found we do nothing\n        if (!documentChunk) {\n          console.warn('_document.js chunk not found')\n          return\n        }\n\n        // Initial value\n        if (this.serverPrevDocumentHash === null) {\n          this.serverPrevDocumentHash = documentChunk.hash\n          return\n        }\n\n        // If _document.js didn't change we don't trigger a reload\n        if (documentChunk.hash === this.serverPrevDocumentHash) {\n          return\n        }\n\n        // Notify reload to reload the page, as _document.js was changed (different hash)\n        this.send('reloadPage')\n        this.serverPrevDocumentHash = documentChunk.hash\n      }\n    )\n\n    multiCompiler.compilers[0].hooks.failed.tap(\n      'NextjsHotReloaderForClient',\n      (err: Error) => {\n        this.clientError = err\n        this.stats = null\n      }\n    )\n    multiCompiler.compilers[0].hooks.done.tap(\n      'NextjsHotReloaderForClient',\n      (stats) => {\n        this.clientError = null\n        this.stats = stats\n\n        const { compilation } = stats\n        const chunkNames = new Set(\n          [...compilation.namedChunks.keys()].filter(\n            (name) => !!getRouteFromEntrypoint(name)\n          )\n        )\n\n        if (this.prevChunkNames) {\n          // detect chunks which have to be replaced with a new template\n          // e.g, pages/index.js <-> pages/_error.js\n          const addedPages = diff(chunkNames, this.prevChunkNames!)\n          const removedPages = diff(this.prevChunkNames!, chunkNames)\n\n          if (addedPages.size > 0) {\n            for (const addedPage of addedPages) {\n              const page = getRouteFromEntrypoint(addedPage)\n              this.send('addedPage', page)\n            }\n          }\n\n          if (removedPages.size > 0) {\n            for (const removedPage of removedPages) {\n              const page = getRouteFromEntrypoint(removedPage)\n              this.send('removedPage', page)\n            }\n          }\n        }\n\n        this.prevChunkNames = chunkNames\n      }\n    )\n\n    this.webpackHotMiddleware = new WebpackHotMiddleware(\n      multiCompiler.compilers\n    )\n\n    let booted = false\n\n    this.watcher = await new Promise((resolve) => {\n      const watcher = multiCompiler.watch(\n        // @ts-ignore webpack supports an array of watchOptions when using a multiCompiler\n        configs.map((config) => config.watchOptions!),\n        // Errors are handled separately\n        (_err: any) => {\n          if (!booted) {\n            booted = true\n            resolve(watcher)\n          }\n        }\n      )\n    })\n\n    this.onDemandEntries = onDemandEntryHandler(this.watcher, multiCompiler, {\n      pagesDir: this.pagesDir,\n      pageExtensions: this.config.pageExtensions,\n      ...(this.config.onDemandEntries as {\n        maxInactiveAge: number\n        pagesBufferLength: number\n      }),\n    })\n\n    this.middlewares = [\n      // must come before hotMiddleware\n      this.onDemandEntries.middleware,\n      this.webpackHotMiddleware.middleware,\n      getOverlayMiddleware({\n        isWebpack5,\n        rootDirectory: this.dir,\n        stats: () => this.stats,\n        serverStats: () => this.serverStats,\n      }),\n    ]\n  }\n\n  public async stop(): Promise<void> {\n    await new Promise((resolve, reject) => {\n      this.watcher.close((err: any) => (err ? reject(err) : resolve(true)))\n    })\n\n    if (this.fallbackWatcher) {\n      await new Promise((resolve, reject) => {\n        this.fallbackWatcher.close((err: any) =>\n          err ? reject(err) : resolve(true)\n        )\n      })\n    }\n  }\n\n  public async getCompilationErrors(page: string) {\n    const normalizedPage = normalizePathSep(page)\n\n    if (this.clientError || this.serverError) {\n      return [this.clientError || this.serverError]\n    } else if (this.stats?.hasErrors()) {\n      const { compilation } = this.stats\n      const failedPages = erroredPages(compilation)\n\n      // If there is an error related to the requesting page we display it instead of the first error\n      if (\n        failedPages[normalizedPage] &&\n        failedPages[normalizedPage].length > 0\n      ) {\n        return failedPages[normalizedPage]\n      }\n\n      // If none were found we still have to show the other errors\n      return this.stats.compilation.errors\n    } else if (this.serverStats?.hasErrors()) {\n      const { compilation } = this.serverStats\n      const failedPages = erroredPages(compilation)\n\n      // If there is an error related to the requesting page we display it instead of the first error\n      if (\n        failedPages[normalizedPage] &&\n        failedPages[normalizedPage].length > 0\n      ) {\n        return failedPages[normalizedPage]\n      }\n\n      // If none were found we still have to show the other errors\n      return this.serverStats.compilation.errors\n    }\n\n    return []\n  }\n\n  public send(action?: string | any, ...args: any[]): void {\n    this.webpackHotMiddleware!.publish(\n      action && typeof action === 'object' ? action : { action, data: args }\n    )\n  }\n\n  public async ensurePage(page: string) {\n    // Make sure we don't re-build or dispose prebuilt pages\n    if (page !== '/_error' && BLOCKED_PAGES.indexOf(page) !== -1) {\n      return\n    }\n    if (this.serverError || this.clientError) {\n      return Promise.reject(this.serverError || this.clientError)\n    }\n    return this.onDemandEntries.ensurePage(page)\n  }\n}\n\nfunction diff(a: Set<any>, b: Set<any>) {\n  return new Set([...a].filter((v) => !b.has(v)))\n}\n"],"names":["renderScriptError","res","error","verbose","setHeader","code","statusCode","end","console","stack","addCorsSupport","req","isApiRoute","url","match","preflight","headers","origin","method","writeHead","matchNextPageBundleRequest","findEntryModule","issuer","erroredPages","compilation","failedPages","errors","entryModule","name","enhancedName","push","HotReloader","dir","config","pagesDir","buildId","previewProps","rewrites","clientError","serverError","middlewares","webpackHotMiddleware","stats","serverStats","serverPrevDocumentHash","isWebpack5","hotReloaderSpan","run","parsedUrl","handlePageBundleRequest","pageBundleRes","parsedPageBundleUrl","pathname","params","decodedPagePath","path","map","param","decodeURIComponent","join","_","page","indexOf","ensurePage","finished","getCompilationErrors","length","fn","Promise","resolve","reject","err","clean","distDir","getWebpackConfig","pagePaths","all","pageExtensions","pages","filter","i","entrypoints","dev","isServer","client","runWebpackSpan","server","buildFallbackError","fallbackWatcher","fallbackConfig","beforeFiles","afterFiles","fallback","isDevFallback","fallbackCompiler","bootedFallbackCompiler","watch","watchOptions","_err","start","configs","defaultEntry","entry","args","isClientCompilation","Object","keys","serverBundlePath","clientBundlePath","absolutePagePath","pageExists","status","pageLoaderOpts","multiCompiler","compilers","changedClientPages","Set","changedServerPages","prevClientPageHashes","Map","prevServerPageHashes","trackPageChanges","pageHashMap","changedItems","forEach","key","startsWith","chunks","chunk","id","prevHash","get","hash","add","set","hooks","emit","tap","failed","done","serverOnlyChanges","clear","send","event","pg","substr","documentChunk","namedChunks","warn","chunkNames","prevChunkNames","addedPages","diff","removedPages","size","addedPage","removedPage","booted","watcher","onDemandEntries","middleware","rootDirectory","stop","close","normalizedPage","hasErrors","action","publish","data","a","b","v","has"],"mappings":"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"}