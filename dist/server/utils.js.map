{"version":3,"sources":["../../server/utils.ts"],"sourcesContent":["import Observable from 'next/dist/compiled/zen-observable'\nimport { BLOCKED_PAGES } from '../shared/lib/constants'\n\nexport function isBlockedPage(pathname: string): boolean {\n  return BLOCKED_PAGES.includes(pathname)\n}\n\nexport function cleanAmpPath(pathname: string): string {\n  if (pathname.match(/\\?amp=(y|yes|true|1)/)) {\n    pathname = pathname.replace(/\\?amp=(y|yes|true|1)&?/, '?')\n  }\n  if (pathname.match(/&amp=(y|yes|true|1)/)) {\n    pathname = pathname.replace(/&amp=(y|yes|true|1)/, '')\n  }\n  pathname = pathname.replace(/\\?$/, '')\n  return pathname\n}\n\nexport type RenderResult = Observable<string>\n\nexport function mergeResults(results: Array<RenderResult>): RenderResult {\n  // @ts-ignore\n  return Observable.prototype.concat.call(...results)\n}\n\nexport async function resultsToString(\n  results: Array<RenderResult>\n): Promise<string> {\n  const chunks: string[] = []\n  await mergeResults(results).forEach((chunk: string) => {\n    chunks.push(chunk)\n  })\n  return chunks.join('')\n}\n"],"names":["isBlockedPage","cleanAmpPath","mergeResults","resultsToString","pathname","includes","match","replace","results","prototype","concat","call","chunks","forEach","chunk","push","join"],"mappings":";;;;QAGgBA,aAAa,GAAbA,aAAa;QAIbC,YAAY,GAAZA,YAAY;QAaZC,YAAY,GAAZA,YAAY;QAKNC,eAAe,GAAfA,eAAe;AAzBd,GAAmC,CAAnC,cAAmC;AAC5B,GAAyB,CAAzB,UAAyB;;;;;;SAEvCH,aAAa,CAACI,QAAgB,EAAW,CAAC;IACxD,MAAM,CAHsB,UAAyB,eAGhCC,QAAQ,CAACD,QAAQ;AACxC,CAAC;SAEeH,YAAY,CAACG,QAAgB,EAAU,CAAC;IACtD,EAAE,EAAEA,QAAQ,CAACE,KAAK,0BAA0B,CAAC;QAC3CF,QAAQ,GAAGA,QAAQ,CAACG,OAAO,2BAA2B,CAAG;IAC3D,CAAC;IACD,EAAE,EAAEH,QAAQ,CAACE,KAAK,yBAAyB,CAAC;QAC1CF,QAAQ,GAAGA,QAAQ,CAACG,OAAO,wBAAwB,CAAE;IACvD,CAAC;IACDH,QAAQ,GAAGA,QAAQ,CAACG,OAAO,QAAQ,CAAE;IACrC,MAAM,CAACH,QAAQ;AACjB,CAAC;SAIeF,YAAY,CAACM,OAA4B,EAAgB,CAAC;IACxE,EAAa,AAAb,WAAa;IACb,MAAM,CAtBe,cAAmC,SAsBtCC,SAAS,CAACC,MAAM,CAACC,IAAI,IAAIH,OAAO;AACpD,CAAC;eAEqBL,eAAe,CACnCK,OAA4B,EACX,CAAC;IAClB,KAAK,CAACI,MAAM,GAAa,CAAC,CAAC;IAC3B,KAAK,CAACV,YAAY,CAACM,OAAO,EAAEK,OAAO,EAAEC,KAAa,GAAK,CAAC;QACtDF,MAAM,CAACG,IAAI,CAACD,KAAK;IACnB,CAAC;IACD,MAAM,CAACF,MAAM,CAACI,IAAI,CAAC,CAAE;AACvB,CAAC"}